(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Qn,y,Mo,At,fi,In={},Po=[],Cu=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Re(t,e){for(var n in e)t[n]=e[n];return t}function Fo(t){var e=t.parentNode;e&&e.removeChild(t)}function $r(t,e,n){var r,s,i,o={};for(i in e)i=="key"?r=e[i]:i=="ref"?s=e[i]:o[i]=e[i];if(arguments.length>2&&(o.children=arguments.length>3?Qn.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)o[i]===void 0&&(o[i]=t.defaultProps[i]);return _n(t,o,r,s,null)}function _n(t,e,n,r,s){var i={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++Mo};return s==null&&y.vnode!=null&&y.vnode(i),i}function ve(t){return t.children}function ce(t,e){this.props=t,this.context=e}function Lt(t,e){if(e==null)return t.__?Lt(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?Lt(t):null}function Vo(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Vo(t)}}function di(t){(!t.__d&&(t.__d=!0)&&At.push(t)&&!Cn.__r++||fi!==y.debounceRendering)&&((fi=y.debounceRendering)||setTimeout)(Cn)}function Cn(){for(var t;Cn.__r=At.length;)t=At.sort(function(e,n){return e.__v.__b-n.__v.__b}),At=[],t.some(function(e){var n,r,s,i,o,a;e.__d&&(o=(i=(n=e).__v).__e,(a=n.__P)&&(r=[],(s=Re({},i)).__v=i.__v+1,gs(a,i,s,n.__n,a.ownerSVGElement!==void 0,i.__h!=null?[o]:null,r,o??Lt(i),i.__h),jo(r,i),i.__e!=o&&Vo(i)))})}function $o(t,e,n,r,s,i,o,a,c,l){var u,d,h,f,p,v,_,E=r&&r.__k||Po,k=E.length;for(n.__k=[],u=0;u<e.length;u++)if((f=n.__k[u]=(f=e[u])==null||typeof f=="boolean"?null:typeof f=="string"||typeof f=="number"||typeof f=="bigint"?_n(null,f,null,null,f):Array.isArray(f)?_n(ve,{children:f},null,null,null):f.__b>0?_n(f.type,f.props,f.key,f.ref?f.ref:null,f.__v):f)!=null){if(f.__=n,f.__b=n.__b+1,(h=E[u])===null||h&&f.key==h.key&&f.type===h.type)E[u]=void 0;else for(d=0;d<k;d++){if((h=E[d])&&f.key==h.key&&f.type===h.type){E[d]=void 0;break}h=null}gs(t,f,h=h||In,s,i,o,a,c,l),p=f.__e,(d=f.ref)&&h.ref!=d&&(_||(_=[]),h.ref&&_.push(h.ref,null,f),_.push(d,f.__c||p,f)),p!=null?(v==null&&(v=p),typeof f.type=="function"&&f.__k===h.__k?f.__d=c=Uo(f,c,t):c=Bo(t,f,h,E,p,c),typeof n.type=="function"&&(n.__d=c)):c&&h.__e==c&&c.parentNode!=t&&(c=Lt(h))}for(n.__e=v,u=k;u--;)E[u]!=null&&Ho(E[u],E[u]);if(_)for(u=0;u<_.length;u++)qo(_[u],_[++u],_[++u])}function Uo(t,e,n){for(var r,s=t.__k,i=0;s&&i<s.length;i++)(r=s[i])&&(r.__=t,e=typeof r.type=="function"?Uo(r,e,n):Bo(n,r,r,s,r.__e,e));return e}function An(t,e){return e=e||[],t==null||typeof t=="boolean"||(Array.isArray(t)?t.some(function(n){An(n,e)}):e.push(t)),e}function Bo(t,e,n,r,s,i){var o,a,c;if(e.__d!==void 0)o=e.__d,e.__d=void 0;else if(n==null||s!=i||s.parentNode==null)e:if(i==null||i.parentNode!==t)t.appendChild(s),o=null;else{for(a=i,c=0;(a=a.nextSibling)&&c<r.length;c+=1)if(a==s)break e;t.insertBefore(s,i),o=i}return o!==void 0?o:s.nextSibling}function Au(t,e,n,r,s){var i;for(i in n)i==="children"||i==="key"||i in e||Dn(t,i,null,n[i],r);for(i in e)s&&typeof e[i]!="function"||i==="children"||i==="key"||i==="value"||i==="checked"||n[i]===e[i]||Dn(t,i,e[i],n[i],r)}function pi(t,e,n){e[0]==="-"?t.setProperty(e,n):t[e]=n==null?"":typeof n!="number"||Cu.test(e)?n:n+"px"}function Dn(t,e,n,r,s){var i;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||pi(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||pi(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")i=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?r||t.addEventListener(e,i?gi:mi,i):t.removeEventListener(e,i?gi:mi,i);else if(e!=="dangerouslySetInnerHTML"){if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e.indexOf("-")==-1?t.removeAttribute(e):t.setAttribute(e,n))}}function mi(t){this.l[t.type+!1](y.event?y.event(t):t)}function gi(t){this.l[t.type+!0](y.event?y.event(t):t)}function gs(t,e,n,r,s,i,o,a,c){var l,u,d,h,f,p,v,_,E,k,J,W,fe,ke,pe,ie=e.type;if(e.constructor!==void 0)return null;n.__h!=null&&(c=n.__h,a=e.__e=n.__e,e.__h=null,i=[a]),(l=y.__b)&&l(e);try{e:if(typeof ie=="function"){if(_=e.props,E=(l=ie.contextType)&&r[l.__c],k=l?E?E.props.value:l.__:r,n.__c?v=(u=e.__c=n.__c).__=u.__E:("prototype"in ie&&ie.prototype.render?e.__c=u=new ie(_,k):(e.__c=u=new ce(_,k),u.constructor=ie,u.render=ku),E&&E.sub(u),u.props=_,u.state||(u.state={}),u.context=k,u.__n=r,d=u.__d=!0,u.__h=[],u._sb=[]),u.__s==null&&(u.__s=u.state),ie.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Re({},u.__s)),Re(u.__s,ie.getDerivedStateFromProps(_,u.__s))),h=u.props,f=u.state,d)ie.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(ie.getDerivedStateFromProps==null&&_!==h&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(_,k),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(_,u.__s,k)===!1||e.__v===n.__v){for(u.props=_,u.state=u.__s,e.__v!==n.__v&&(u.__d=!1),u.__v=e,e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(de){de&&(de.__=e)}),J=0;J<u._sb.length;J++)u.__h.push(u._sb[J]);u._sb=[],u.__h.length&&o.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(_,u.__s,k),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(h,f,p)})}if(u.context=k,u.props=_,u.__v=e,u.__P=t,W=y.__r,fe=0,"prototype"in ie&&ie.prototype.render){for(u.state=u.__s,u.__d=!1,W&&W(e),l=u.render(u.props,u.state,u.context),ke=0;ke<u._sb.length;ke++)u.__h.push(u._sb[ke]);u._sb=[]}else do u.__d=!1,W&&W(e),l=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++fe<25);u.state=u.__s,u.getChildContext!=null&&(r=Re(Re({},r),u.getChildContext())),d||u.getSnapshotBeforeUpdate==null||(p=u.getSnapshotBeforeUpdate(h,f)),pe=l!=null&&l.type===ve&&l.key==null?l.props.children:l,$o(t,Array.isArray(pe)?pe:[pe],e,n,r,s,i,o,a,c),u.base=e.__e,e.__h=null,u.__h.length&&o.push(u),v&&(u.__E=u.__=null),u.__e=!1}else i==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=Du(n.__e,e,n,r,s,i,o,c);(l=y.diffed)&&l(e)}catch(de){e.__v=null,(c||i!=null)&&(e.__e=a,e.__h=!!c,i[i.indexOf(a)]=null),y.__e(de,e,n)}}function jo(t,e){y.__c&&y.__c(e,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(r){r.call(n)})}catch(r){y.__e(r,n.__v)}})}function Du(t,e,n,r,s,i,o,a){var c,l,u,d=n.props,h=e.props,f=e.type,p=0;if(f==="svg"&&(s=!0),i!=null){for(;p<i.length;p++)if((c=i[p])&&"setAttribute"in c==!!f&&(f?c.localName===f:c.nodeType===3)){t=c,i[p]=null;break}}if(t==null){if(f===null)return document.createTextNode(h);t=s?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,h.is&&h),i=null,a=!1}if(f===null)d===h||a&&t.data===h||(t.data=h);else{if(i=i&&Qn.call(t.childNodes),l=(d=n.props||In).dangerouslySetInnerHTML,u=h.dangerouslySetInnerHTML,!a){if(i!=null)for(d={},p=0;p<t.attributes.length;p++)d[t.attributes[p].name]=t.attributes[p].value;(u||l)&&(u&&(l&&u.__html==l.__html||u.__html===t.innerHTML)||(t.innerHTML=u&&u.__html||""))}if(Au(t,h,d,s,a),u)e.__k=[];else if(p=e.props.children,$o(t,Array.isArray(p)?p:[p],e,n,r,s&&f!=="foreignObject",i,o,i?i[0]:n.__k&&Lt(n,0),a),i!=null)for(p=i.length;p--;)i[p]!=null&&Fo(i[p]);a||("value"in h&&(p=h.value)!==void 0&&(p!==t.value||f==="progress"&&!p||f==="option"&&p!==d.value)&&Dn(t,"value",p,d.value,!1),"checked"in h&&(p=h.checked)!==void 0&&p!==t.checked&&Dn(t,"checked",p,d.checked,!1))}return t}function qo(t,e,n){try{typeof t=="function"?t(e):t.current=e}catch(r){y.__e(r,n)}}function Ho(t,e,n){var r,s;if(y.unmount&&y.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||qo(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(i){y.__e(i,e)}r.base=r.__P=null,t.__c=void 0}if(r=t.__k)for(s=0;s<r.length;s++)r[s]&&Ho(r[s],e,n||typeof t.type!="function");n||t.__e==null||Fo(t.__e),t.__=t.__e=t.__d=void 0}function ku(t,e,n){return this.constructor(t,n)}function Nu(t,e,n){var r,s,i;y.__&&y.__(t,e),s=(r=typeof n=="function")?null:n&&n.__k||e.__k,i=[],gs(e,t=(!r&&n||e).__k=$r(ve,null,[t]),s||In,In,e.ownerSVGElement!==void 0,!r&&n?[n]:s?null:e.firstChild?Qn.call(e.childNodes):null,i,!r&&n?n:s?s.__e:e.firstChild,r),jo(i,t)}Qn=Po.slice,y={__e:function(t,e,n,r){for(var s,i,o;e=e.__;)if((s=e.__c)&&!s.__)try{if((i=s.constructor)&&i.getDerivedStateFromError!=null&&(s.setState(i.getDerivedStateFromError(t)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(t,r||{}),o=s.__d),o)return s.__E=s}catch(a){t=a}throw t}},Mo=0,ce.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Re({},this.state),typeof t=="function"&&(t=t(Re({},n),this.props)),t&&Re(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),di(this))},ce.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),di(this))},ce.prototype.render=ve,At=[],Cn.__r=0;function Ne(t,e){return y.__a&&y.__a(e),t}typeof window<"u"&&window.__PREACT_DEVTOOLS__&&window.__PREACT_DEVTOOLS__.attachPreact("10.11.3",y,{Fragment:ve,Component:ce});var yi={};function xe(t){return t.type===ve?"Fragment":typeof t.type=="function"?t.type.displayName||t.type.name:typeof t.type=="string"?t.type:"#text"}var Dt=[],Ze=[];function Ko(){return Dt.length>0?Dt[Dt.length-1]:null}var vi=!1;function Er(t){return typeof t.type=="function"&&t.type!=ve}function oe(t){for(var e=[t],n=t;n.__o!=null;)e.push(n.__o),n=n.__o;return e.reduce(function(r,s){r+="  in "+xe(s);var i=s.__source;return i?r+=" (at "+i.fileName+":"+i.lineNumber+")":vi||(vi=!0,console.warn("Add @babel/plugin-transform-react-jsx-source to get a more detailed component stack. Note that you should not add it to production builds of your App for bundle size reasons.")),r+`
`},"")}var xu=typeof WeakMap=="function";function zo(t){return t?typeof t.type=="function"?zo(t.__):t:{}}var Ru=ce.prototype.setState;ce.prototype.setState=function(t,e){return this.__v==null&&this.state==null&&console.warn(`Calling "this.setState" inside the constructor of a component is a no-op and might be a bug in your application. Instead, set "this.state = {}" directly.

`+oe(Ko())),Ru.call(this,t,e)};var Ou=ce.prototype.forceUpdate;function Ee(t){var e=t.props,n=xe(t),r="";for(var s in e)if(e.hasOwnProperty(s)&&s!=="children"){var i=e[s];typeof i=="function"&&(i="function "+(i.displayName||i.name)+"() {}"),i=Object(i)!==i||i.toString?i+"":Object.prototype.toString.call(i),r+=" "+s+"="+JSON.stringify(i)}var o=e.children;return"<"+n+r+(o&&o.length?">..</"+n+">":" />")}ce.prototype.forceUpdate=function(t){return this.__v==null?console.warn(`Calling "this.forceUpdate" inside the constructor of a component is a no-op and might be a bug in your application.

`+oe(Ko())):this.__P==null&&console.warn(`Can't call "this.forceUpdate" on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in the componentWillUnmount method.

`+oe(this.__v)),Ou.call(this,t)},function(){(function(){var h=y.__b,f=y.diffed,p=y.__,v=y.vnode,_=y.__r;y.diffed=function(E){Er(E)&&Ze.pop(),Dt.pop(),f&&f(E)},y.__b=function(E){Er(E)&&Dt.push(E),h&&h(E)},y.__=function(E,k){Ze=[],p&&p(E,k)},y.vnode=function(E){E.__o=Ze.length>0?Ze[Ze.length-1]:null,v&&v(E)},y.__r=function(E){Er(E)&&Ze.push(E),_&&_(E)}})();var t=!1,e=y.__b,n=y.diffed,r=y.vnode,s=y.__e,i=y.__,o=y.__h,a=xu?{useEffect:new WeakMap,useLayoutEffect:new WeakMap,lazyPropTypes:new WeakMap}:null,c=[];y.__e=function(h,f,p,v){if(f&&f.__c&&typeof h.then=="function"){var _=h;h=new Error("Missing Suspense. The throwing component was: "+xe(f));for(var E=f;E;E=E.__)if(E.__c&&E.__c.__c){h=_;break}if(h instanceof Error)throw h}try{(v=v||{}).componentStack=oe(f),s(h,f,p,v),typeof h.then!="function"&&setTimeout(function(){throw h})}catch(k){throw k}},y.__=function(h,f){if(!f)throw new Error(`Undefined parent passed to render(), this is the second argument.
Check if the element is available in the DOM/has the correct id.`);var p;switch(f.nodeType){case 1:case 11:case 9:p=!0;break;default:p=!1}if(!p){var v=xe(h);throw new Error("Expected a valid HTML node as a second argument to render.	Received "+f+" instead: render(<"+v+" />, "+f+");")}i&&i(h,f)},y.__b=function(h){var f=h.type,p=zo(h.__);if(t=!0,f===void 0)throw new Error(`Undefined component passed to createElement()

You likely forgot to export your component or might have mixed up default and named imports`+Ee(h)+`

`+oe(h));if(f!=null&&typeof f=="object")throw f.__k!==void 0&&f.__e!==void 0?new Error("Invalid type passed to createElement(): "+f+`

Did you accidentally pass a JSX literal as JSX twice?

  let My`+xe(h)+" = "+Ee(f)+`;
  let vnode = <My`+xe(h)+` />;

This usually happens when you export a JSX literal and not the component.

`+oe(h)):new Error("Invalid type passed to createElement(): "+(Array.isArray(f)?"array":f));if(f!=="thead"&&f!=="tfoot"&&f!=="tbody"||p.type==="table"?f==="tr"&&p.type!=="thead"&&p.type!=="tfoot"&&p.type!=="tbody"&&p.type!=="table"?console.error("Improper nesting of table. Your <tr> should have a <thead/tbody/tfoot/table> parent."+Ee(h)+`

`+oe(h)):f==="td"&&p.type!=="tr"?console.error("Improper nesting of table. Your <td> should have a <tr> parent."+Ee(h)+`

`+oe(h)):f==="th"&&p.type!=="tr"&&console.error("Improper nesting of table. Your <th> should have a <tr>."+Ee(h)+`

`+oe(h)):console.error("Improper nesting of table. Your <thead/tbody/tfoot> should have a <table> parent."+Ee(h)+`

`+oe(h)),h.ref!==void 0&&typeof h.ref!="function"&&typeof h.ref!="object"&&!("$$typeof"in h))throw new Error(`Component's "ref" property should be a function, or an object created by createRef(), but got [`+typeof h.ref+`] instead
`+Ee(h)+`

`+oe(h));if(typeof h.type=="string"){for(var v in h.props)if(v[0]==="o"&&v[1]==="n"&&typeof h.props[v]!="function"&&h.props[v]!=null)throw new Error(`Component's "`+v+'" property should be a function, but got ['+typeof h.props[v]+`] instead
`+Ee(h)+`

`+oe(h))}if(typeof h.type=="function"&&h.type.propTypes){if(h.type.displayName==="Lazy"&&a&&!a.lazyPropTypes.has(h.type)){var _="PropTypes are not supported on lazy(). Use propTypes on the wrapped component itself. ";try{var E=h.type();a.lazyPropTypes.set(h.type,!0),console.warn(_+"Component wrapped in lazy() is "+xe(E))}catch{console.warn(_+"We will log the wrapped component's name once it is loaded.")}}var k=h.props;h.type.__f&&delete(k=function(J,W){for(var fe in W)J[fe]=W[fe];return J}({},k)).ref,function(J,W,fe,ke,pe){Object.keys(J).forEach(function(ie){var de;try{de=J[ie](W,ie,ke,"prop",null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Iu){de=Iu}de&&!(de.message in yi)&&(yi[de.message]=!0,console.error("Failed prop type: "+de.message+(pe&&`
`+pe()||"")))})}(h.type.propTypes,k,0,xe(h),function(){return oe(h)})}e&&e(h)},y.__h=function(h,f,p){if(!h||!t)throw new Error("Hook can only be invoked from render methods.");o&&o(h,f,p)};var l=function(h,f){return{get:function(){var p="get"+h+f;c&&c.indexOf(p)<0&&(c.push(p),console.warn("getting vnode."+h+" is deprecated, "+f))},set:function(){var p="set"+h+f;c&&c.indexOf(p)<0&&(c.push(p),console.warn("setting vnode."+h+" is not allowed, "+f))}}},u={nodeName:l("nodeName","use vnode.type"),attributes:l("attributes","use vnode.props"),children:l("children","use vnode.props.children")},d=Object.create({},u);y.vnode=function(h){var f=h.props;if(h.type!==null&&f!=null&&("__source"in f||"__self"in f)){var p=h.props={};for(var v in f){var _=f[v];v==="__source"?h.__source=_:v==="__self"?h.__self=_:p[v]=_}}h.__proto__=d,r&&r(h)},y.diffed=function(h){if(h.__k&&h.__k.forEach(function(E){if(E&&E.type===void 0){delete E.__,delete E.__b;var k=Object.keys(E).join(",");throw new Error("Objects are not valid as a child. Encountered an object with the keys {"+k+`}.

`+oe(h))}}),t=!1,n&&n(h),h.__k!=null)for(var f=[],p=0;p<h.__k.length;p++){var v=h.__k[p];if(v&&v.key!=null){var _=v.key;if(f.indexOf(_)!==-1){console.error('Following component has two or more children with the same key attribute: "'+_+`". This may cause glitches and misbehavior in rendering process. Component: 

`+Ee(h)+`

`+oe(h));break}f.push(_)}}}}();const Go=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Lu=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Wo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,l=c?t[s+2]:0,u=i>>2,d=(i&3)<<4|a>>4;let h=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(h=64)),r.push(n[u],n[d],n[h],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Go(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Lu(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const l=s<t.length?n[t.charAt(s)]:64;++s;const d=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||l==null||d==null)throw Error();const h=i<<2|a>>4;if(r.push(h),l!==64){const f=a<<4&240|l>>2;if(r.push(f),d!==64){const p=l<<6&192|d;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Mu=function(t){const e=Go(t);return Wo.encodeByteArray(e,!0)},kn=function(t){return Mu(t).replace(/\./g,"")},Pu=function(t){try{return Wo.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Fu(){try{return typeof indexedDB=="object"}catch{return!1}}function Vu(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function $u(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Uu=()=>$u().__FIREBASE_DEFAULTS__,Bu=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ju=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Pu(t[1]);return e&&JSON.parse(e)},Qo=()=>{try{return Uu()||Bu()||ju()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},qu=t=>{var e,n;return(n=(e=Qo())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Hu=t=>{const e=qu(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Ku=()=>{var t;return(t=Qo())===null||t===void 0?void 0:t.config};class zu{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}function Gu(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[kn(JSON.stringify(n)),kn(JSON.stringify(o)),a].join(".")}const Wu="FirebaseError";class gt extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Wu,Object.setPrototypeOf(this,gt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xo.prototype.create)}}class Xo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Qu(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new gt(s,a,r)}}function Qu(t,e){return t.replace(Xu,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Xu=/\{\$([^}]+)}/g;function Ur(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(_i(i)&&_i(o)){if(!Ur(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function _i(t){return t!==null&&typeof t=="object"}function Nn(t){return t&&t._delegate?t._delegate:t}class Mt{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Be="[DEFAULT]";class Yu{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new zu;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Zu(e))try{this.getOrInitializeService({instanceIdentifier:Be})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Be){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Be){return this.instances.has(e)}getOptions(e=Be){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Ju(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Be){return this.component?this.component.multipleInstances?e:Be:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ju(t){return t===Be?void 0:t}function Zu(t){return t.instantiationMode==="EAGER"}class el{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Yu(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var R;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(R||(R={}));const tl={debug:R.DEBUG,verbose:R.VERBOSE,info:R.INFO,warn:R.WARN,error:R.ERROR,silent:R.SILENT},nl=R.INFO,rl={[R.DEBUG]:"log",[R.VERBOSE]:"log",[R.INFO]:"info",[R.WARN]:"warn",[R.ERROR]:"error"},sl=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=rl[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Yo{constructor(e){this.name=e,this._logLevel=nl,this._logHandler=sl,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in R))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tl[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,R.DEBUG,...e),this._logHandler(this,R.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,R.VERBOSE,...e),this._logHandler(this,R.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,R.INFO,...e),this._logHandler(this,R.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,R.WARN,...e),this._logHandler(this,R.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,R.ERROR,...e),this._logHandler(this,R.ERROR,...e)}}const il=(t,e)=>e.some(n=>t instanceof n);let wi,Ei;function ol(){return wi||(wi=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function al(){return Ei||(Ei=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jo=new WeakMap,Br=new WeakMap,Zo=new WeakMap,br=new WeakMap,ys=new WeakMap;function cl(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Oe(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Jo.set(n,t)}).catch(()=>{}),ys.set(e,t),e}function ul(t){if(Br.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Br.set(t,e)}let jr={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Br.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Zo.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oe(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ll(t){jr=t(jr)}function hl(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Tr(this),e,...n);return Zo.set(r,e.sort?e.sort():[e]),Oe(r)}:al().includes(t)?function(...e){return t.apply(Tr(this),e),Oe(Jo.get(this))}:function(...e){return Oe(t.apply(Tr(this),e))}}function fl(t){return typeof t=="function"?hl(t):(t instanceof IDBTransaction&&ul(t),il(t,ol())?new Proxy(t,jr):t)}function Oe(t){if(t instanceof IDBRequest)return cl(t);if(br.has(t))return br.get(t);const e=fl(t);return e!==t&&(br.set(t,e),ys.set(e,t)),e}const Tr=t=>ys.get(t);function dl(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Oe(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Oe(o.result),c.oldVersion,c.newVersion,Oe(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const pl=["get","getKey","getAll","getAllKeys","count"],ml=["put","add","delete","clear"],Sr=new Map;function bi(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Sr.get(e))return Sr.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=ml.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||pl.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),s&&c.done]))[0]};return Sr.set(e,i),i}ll(t=>({...t,get:(e,n,r)=>bi(e,n)||t.get(e,n,r),has:(e,n)=>!!bi(e,n)||t.has(e,n)}));class gl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(yl(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function yl(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const qr="@firebase/app",Ti="0.9.0";const Ge=new Yo("@firebase/app"),vl="@firebase/app-compat",_l="@firebase/analytics-compat",wl="@firebase/analytics",El="@firebase/app-check-compat",bl="@firebase/app-check",Tl="@firebase/auth",Sl="@firebase/auth-compat",Il="@firebase/database",Cl="@firebase/database-compat",Al="@firebase/functions",Dl="@firebase/functions-compat",kl="@firebase/installations",Nl="@firebase/installations-compat",xl="@firebase/messaging",Rl="@firebase/messaging-compat",Ol="@firebase/performance",Ll="@firebase/performance-compat",Ml="@firebase/remote-config",Pl="@firebase/remote-config-compat",Fl="@firebase/storage",Vl="@firebase/storage-compat",$l="@firebase/firestore",Ul="@firebase/firestore-compat",Bl="firebase",jl="9.15.0";const Hr="[DEFAULT]",ql={[qr]:"fire-core",[vl]:"fire-core-compat",[wl]:"fire-analytics",[_l]:"fire-analytics-compat",[bl]:"fire-app-check",[El]:"fire-app-check-compat",[Tl]:"fire-auth",[Sl]:"fire-auth-compat",[Il]:"fire-rtdb",[Cl]:"fire-rtdb-compat",[Al]:"fire-fn",[Dl]:"fire-fn-compat",[kl]:"fire-iid",[Nl]:"fire-iid-compat",[xl]:"fire-fcm",[Rl]:"fire-fcm-compat",[Ol]:"fire-perf",[Ll]:"fire-perf-compat",[Ml]:"fire-rc",[Pl]:"fire-rc-compat",[Fl]:"fire-gcs",[Vl]:"fire-gcs-compat",[$l]:"fire-fst",[Ul]:"fire-fst-compat","fire-js":"fire-js",[Bl]:"fire-js-all"};const xn=new Map,Kr=new Map;function Hl(t,e){try{t.container.addComponent(e)}catch(n){Ge.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Rn(t){const e=t.name;if(Kr.has(e))return Ge.debug(`There were multiple attempts to register component ${e}.`),!1;Kr.set(e,t);for(const n of xn.values())Hl(n,t);return!0}function Kl(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const zl={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Le=new Xo("app","Firebase",zl);class Gl{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Mt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Le.create("app-deleted",{appName:this._name})}}const Wl=jl;function ea(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Hr,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Le.create("bad-app-name",{appName:String(s)});if(n||(n=Ku()),!n)throw Le.create("no-options");const i=xn.get(s);if(i){if(Ur(n,i.options)&&Ur(r,i.config))return i;throw Le.create("duplicate-app",{appName:s})}const o=new el(s);for(const c of Kr.values())o.addComponent(c);const a=new Gl(n,r,o);return xn.set(s,a),a}function Ql(t=Hr){const e=xn.get(t);if(!e&&t===Hr)return ea();if(!e)throw Le.create("no-app",{appName:t});return e}function it(t,e,n){var r;let s=(r=ql[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ge.warn(a.join(" "));return}Rn(new Mt(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const Xl="firebase-heartbeat-database",Yl=1,Pt="firebase-heartbeat-store";let Ir=null;function ta(){return Ir||(Ir=dl(Xl,Yl,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Pt)}}}).catch(t=>{throw Le.create("idb-open",{originalErrorMessage:t.message})})),Ir}async function Jl(t){try{return(await ta()).transaction(Pt).objectStore(Pt).get(na(t))}catch(e){if(e instanceof gt)Ge.warn(e.message);else{const n=Le.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ge.warn(n.message)}}}async function Si(t,e){try{const r=(await ta()).transaction(Pt,"readwrite");return await r.objectStore(Pt).put(e,na(t)),r.done}catch(n){if(n instanceof gt)Ge.warn(n.message);else{const r=Le.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ge.warn(r.message)}}}function na(t){return`${t.name}!${t.options.appId}`}const Zl=1024,eh=30*24*60*60*1e3;class th{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new rh(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ii();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=eh}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ii(),{heartbeatsToSend:n,unsentEntries:r}=nh(this._heartbeatsCache.heartbeats),s=kn(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Ii(){return new Date().toISOString().substring(0,10)}function nh(t,e=Zl){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ci(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ci(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class rh{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fu()?Vu().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Jl(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Si(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Si(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ci(t){return kn(JSON.stringify({version:2,heartbeats:t})).length}function sh(t){Rn(new Mt("platform-logger",e=>new gl(e),"PRIVATE")),Rn(new Mt("heartbeat",e=>new th(e),"PRIVATE")),it(qr,Ti,t),it(qr,Ti,"esm2017"),it("fire-js","")}sh("");var ih=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},w,vs=vs||{},I=ih||self;function On(){}function Xn(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Xt(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function oh(t){return Object.prototype.hasOwnProperty.call(t,Cr)&&t[Cr]||(t[Cr]=++ah)}var Cr="closure_uid_"+(1e9*Math.random()>>>0),ah=0;function ch(t,e,n){return t.call.apply(t.bind,arguments)}function uh(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function ne(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?ne=ch:ne=uh,ne.apply(null,arguments)}function fn(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Y(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Wb=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function $e(){this.s=this.s,this.o=this.o}var lh=0;$e.prototype.s=!1;$e.prototype.na=function(){!this.s&&(this.s=!0,this.M(),lh!=0)&&oh(this)};$e.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const ra=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function _s(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Ai(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Xn(r)){const s=t.length||0,i=r.length||0;t.length=s+i;for(let o=0;o<i;o++)t[s+o]=r[o]}else t.push(r)}}function re(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}re.prototype.h=function(){this.defaultPrevented=!0};var hh=function(){if(!I.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{I.addEventListener("test",On,e),I.removeEventListener("test",On,e)}catch{}return t}();function Ln(t){return/^[\s\xa0]*$/.test(t)}var Di=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Ar(t,e){return t<e?-1:t>e?1:0}function Yn(){var t=I.navigator;return t&&(t=t.userAgent)?t:""}function me(t){return Yn().indexOf(t)!=-1}function ws(t){return ws[" "](t),t}ws[" "]=On;function fh(t){var e=mh;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var dh=me("Opera"),ct=me("Trident")||me("MSIE"),sa=me("Edge"),zr=sa||ct,ia=me("Gecko")&&!(Yn().toLowerCase().indexOf("webkit")!=-1&&!me("Edge"))&&!(me("Trident")||me("MSIE"))&&!me("Edge"),ph=Yn().toLowerCase().indexOf("webkit")!=-1&&!me("Edge");function oa(){var t=I.document;return t?t.documentMode:void 0}var Mn;e:{var Dr="",kr=function(){var t=Yn();if(ia)return/rv:([^\);]+)(\)|;)/.exec(t);if(sa)return/Edge\/([\d\.]+)/.exec(t);if(ct)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(ph)return/WebKit\/(\S+)/.exec(t);if(dh)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(kr&&(Dr=kr?kr[1]:""),ct){var Nr=oa();if(Nr!=null&&Nr>parseFloat(Dr)){Mn=String(Nr);break e}}Mn=Dr}var mh={};function gh(){return fh(function(){let t=0;const e=Di(String(Mn)).split("."),n=Di("9").split("."),r=Math.max(e.length,n.length);for(let o=0;t==0&&o<r;o++){var s=e[o]||"",i=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s[0].length==0&&i[0].length==0)break;t=Ar(s[1].length==0?0:parseInt(s[1],10),i[1].length==0?0:parseInt(i[1],10))||Ar(s[2].length==0,i[2].length==0)||Ar(s[2],i[2]),s=s[3],i=i[3]}while(t==0)}return 0<=t})}var Gr;if(I.document&&ct){var ki=oa();Gr=ki||parseInt(Mn,10)||void 0}else Gr=void 0;var yh=Gr;function Ft(t,e){if(re.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ia){e:{try{ws(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:vh[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ft.X.h.call(this)}}Y(Ft,re);var vh={2:"touch",3:"pen",4:"mouse"};Ft.prototype.h=function(){Ft.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Yt="closure_listenable_"+(1e6*Math.random()|0),_h=0;function wh(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ha=s,this.key=++_h,this.ba=this.ea=!1}function Jn(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function Es(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function aa(t){const e={};for(const n in t)e[n]=t[n];return e}const Ni="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ca(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<Ni.length;i++)n=Ni[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Zn(t){this.src=t,this.g={},this.h=0}Zn.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Qr(t,e,r,s);return-1<o?(e=t[o],n||(e.ea=!1)):(e=new wh(e,this.src,i,!!r,s),e.ea=n,t.push(e)),e};function Wr(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=ra(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Jn(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Qr(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.ba&&i.listener==e&&i.capture==!!n&&i.ha==r)return s}return-1}var bs="closure_lm_"+(1e6*Math.random()|0),xr={};function ua(t,e,n,r,s){if(r&&r.once)return ha(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)ua(t,e[i],n,r,s);return null}return n=Is(n),t&&t[Yt]?t.N(e,n,Xt(r)?!!r.capture:!!r,s):la(t,e,n,!1,r,s)}function la(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=Xt(s)?!!s.capture:!!s,a=Ss(t);if(a||(t[bs]=a=new Zn(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=Eh(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)hh||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(da(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Eh(){function t(n){return e.call(t.src,t.listener,n)}const e=bh;return t}function ha(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)ha(t,e[i],n,r,s);return null}return n=Is(n),t&&t[Yt]?t.O(e,n,Xt(r)?!!r.capture:!!r,s):la(t,e,n,!0,r,s)}function fa(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)fa(t,e[i],n,r,s);else r=Xt(r)?!!r.capture:!!r,n=Is(n),t&&t[Yt]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Qr(i,n,r,s),-1<n&&(Jn(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=Ss(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Qr(e,n,r,s)),(n=-1<t?e[t]:null)&&Ts(n))}function Ts(t){if(typeof t!="number"&&t&&!t.ba){var e=t.src;if(e&&e[Yt])Wr(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(da(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ss(e))?(Wr(n,t),n.h==0&&(n.src=null,e[bs]=null)):Jn(t)}}}function da(t){return t in xr?xr[t]:xr[t]="on"+t}function bh(t,e){if(t.ba)t=!0;else{e=new Ft(e,this);var n=t.listener,r=t.ha||t.src;t.ea&&Ts(t),t=n.call(r,e)}return t}function Ss(t){return t=t[bs],t instanceof Zn?t:null}var Rr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Is(t){return typeof t=="function"?t:(t[Rr]||(t[Rr]=function(e){return t.handleEvent(e)}),t[Rr])}function G(){$e.call(this),this.i=new Zn(this),this.P=this,this.I=null}Y(G,$e);G.prototype[Yt]=!0;G.prototype.removeEventListener=function(t,e,n,r){fa(this,t,e,n,r)};function X(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new re(e,t);else if(e instanceof re)e.target=e.target||t;else{var s=e;e=new re(r,t),ca(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=dn(o,r,!0,e)&&s}if(o=e.g=t,s=dn(o,r,!0,e)&&s,s=dn(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=dn(o,r,!1,e)&&s}G.prototype.M=function(){if(G.X.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Jn(n[r]);delete t.g[e],t.h--}}this.I=null};G.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};G.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function dn(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ba&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.ea&&Wr(t.i,o),s=a.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var Cs=I.JSON.stringify;function Th(){var t=ga;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Sh{constructor(){this.h=this.g=null}add(e,n){const r=pa.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var pa=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Ih,t=>t.reset());class Ih{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Ch(t){I.setTimeout(()=>{throw t},0)}function ma(t,e){Xr||Ah(),Yr||(Xr(),Yr=!0),ga.add(t,e)}var Xr;function Ah(){var t=I.Promise.resolve(void 0);Xr=function(){t.then(Dh)}}var Yr=!1,ga=new Sh;function Dh(){for(var t;t=Th();){try{t.h.call(t.g)}catch(n){Ch(n)}var e=pa;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Yr=!1}function er(t,e){G.call(this),this.h=t||1,this.g=e||I,this.j=ne(this.lb,this),this.l=Date.now()}Y(er,G);w=er.prototype;w.ca=!1;w.R=null;w.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),X(this,"tick"),this.ca&&(As(this),this.start()))}};w.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function As(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}w.M=function(){er.X.M.call(this),As(this),delete this.g};function Ds(t,e,n){if(typeof t=="function")n&&(t=ne(t,n));else if(t&&typeof t.handleEvent=="function")t=ne(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:I.setTimeout(t,e||0)}function ya(t){t.g=Ds(()=>{t.g=null,t.i&&(t.i=!1,ya(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class kh extends $e{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ya(this)}M(){super.M(),this.g&&(I.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vt(t){$e.call(this),this.h=t,this.g={}}Y(Vt,$e);var xi=[];function va(t,e,n,r){Array.isArray(n)||(n&&(xi[0]=n.toString()),n=xi);for(var s=0;s<n.length;s++){var i=ua(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function _a(t){Es(t.g,function(e,n){this.g.hasOwnProperty(n)&&Ts(e)},t),t.g={}}Vt.prototype.M=function(){Vt.X.M.call(this),_a(this)};Vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function tr(){this.g=!0}tr.prototype.Aa=function(){this.g=!1};function Nh(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var d=u.split("_");o=2<=d.length&&d[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function xh(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function rt(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Oh(t,n)+(r?" "+r:"")})}function Rh(t,e){t.info(function(){return"TIMEOUT: "+e})}tr.prototype.info=function(){};function Oh(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return Cs(n)}catch{return e}}var Xe={},Ri=null;function nr(){return Ri=Ri||new G}Xe.Pa="serverreachability";function wa(t){re.call(this,Xe.Pa,t)}Y(wa,re);function $t(t){const e=nr();X(e,new wa(e))}Xe.STAT_EVENT="statevent";function Ea(t,e){re.call(this,Xe.STAT_EVENT,t),this.stat=e}Y(Ea,re);function ae(t){const e=nr();X(e,new Ea(e,t))}Xe.Qa="timingevent";function ba(t,e){re.call(this,Xe.Qa,t),this.size=e}Y(ba,re);function Jt(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return I.setTimeout(function(){t()},e)}var rr={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Ta={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function ks(){}ks.prototype.h=null;function Oi(t){return t.h||(t.h=t.i())}function Sa(){}var Zt={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function Ns(){re.call(this,"d")}Y(Ns,re);function xs(){re.call(this,"c")}Y(xs,re);var Jr;function sr(){}Y(sr,ks);sr.prototype.g=function(){return new XMLHttpRequest};sr.prototype.i=function(){return{}};Jr=new sr;function en(t,e,n,r){this.l=t,this.j=e,this.m=n,this.U=r||1,this.S=new Vt(this),this.O=Lh,t=zr?125:void 0,this.T=new er(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Ia}function Ia(){this.i=null,this.g="",this.h=!1}var Lh=45e3,Zr={},Pn={};w=en.prototype;w.setTimeout=function(t){this.O=t};function es(t,e,n){t.K=1,t.v=or(Ie(e)),t.s=n,t.P=!0,Ca(t,null)}function Ca(t,e){t.F=Date.now(),tn(t),t.A=Ie(t.v);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),La(n.i,"t",r),t.C=0,n=t.l.H,t.h=new Ia,t.g=tc(t.l,n?e:null,!t.s),0<t.N&&(t.L=new kh(ne(t.La,t,t.g),t.N)),va(t.S,t.g,"readystatechange",t.ib),e=t.H?aa(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),$t(),Nh(t.j,t.u,t.A,t.m,t.U,t.s)}w.ib=function(t){t=t.target;const e=this.L;e&&Te(t)==3?e.l():this.La(t)};w.La=function(t){try{if(t==this.g)e:{const u=Te(this.g);var e=this.g.Ea();const d=this.g.aa();if(!(3>u)&&(u!=3||zr||this.g&&(this.h.h||this.g.fa()||Fi(this.g)))){this.I||u!=4||e==7||(e==8||0>=d?$t(3):$t(2)),ir(this);var n=this.g.aa();this.Y=n;t:if(Aa(this)){var r=Fi(this.g);t="";var s=r.length,i=Te(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){je(this),kt(this);var o="";break t}this.h.i=new I.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=n==200,xh(this.j,this.u,this.A,this.m,this.U,u,n),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ln(a)){var l=a;break t}}l=null}if(n=l)rt(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ts(this,n);else{this.i=!1,this.o=3,ae(12),je(this),kt(this);break e}}this.P?(Da(this,u,o),zr&&this.i&&u==3&&(va(this.S,this.T,"tick",this.hb),this.T.start())):(rt(this.j,this.m,o,null),ts(this,o)),u==4&&je(this),this.i&&!this.I&&(u==4?Ya(this.l,this):(this.i=!1,tn(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,ae(12)):(this.o=0,ae(13)),je(this),kt(this)}}}catch{}finally{}};function Aa(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Da:!1}function Da(t,e,n){let r=!0,s;for(;!t.I&&t.C<n.length;)if(s=Mh(t,n),s==Pn){e==4&&(t.o=4,ae(14),r=!1),rt(t.j,t.m,null,"[Incomplete Response]");break}else if(s==Zr){t.o=4,ae(15),rt(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else rt(t.j,t.m,s,null),ts(t,s);Aa(t)&&s!=Pn&&s!=Zr&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,ae(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.$&&(t.$=!0,e=t.l,e.g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Vs(e),e.K=!0,ae(11))):(rt(t.j,t.m,n,"[Invalid Chunked Response]"),je(t),kt(t))}w.hb=function(){if(this.g){var t=Te(this.g),e=this.g.fa();this.C<e.length&&(ir(this),Da(this,t,e),this.i&&t!=4&&tn(this))}};function Mh(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Pn:(n=Number(e.substring(n,r)),isNaN(n)?Zr:(r+=1,r+n>e.length?Pn:(e=e.substr(r,n),t.C=r+n,e)))}w.cancel=function(){this.I=!0,je(this)};function tn(t){t.V=Date.now()+t.O,ka(t,t.O)}function ka(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Jt(ne(t.gb,t),e)}function ir(t){t.B&&(I.clearTimeout(t.B),t.B=null)}w.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(Rh(this.j,this.A),this.K!=2&&($t(),ae(17)),je(this),this.o=2,kt(this)):ka(this,this.V-t)};function kt(t){t.l.G==0||t.I||Ya(t.l,t)}function je(t){ir(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,As(t.T),_a(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function ts(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||ns(n.h,t))){if(!t.J&&ns(n.h,t)&&n.G==3){try{var r=n.Fa.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)$n(n),ur(n);else break e;Fs(n),ae(18)}}else n.Ba=s[1],0<n.Ba-n.T&&37500>s[2]&&n.L&&n.A==0&&!n.v&&(n.v=Jt(ne(n.cb,n),6e3));if(1>=Fa(n.h)&&n.ja){try{n.ja()}catch{}n.ja=void 0}}else qe(n,11)}else if((t.J||n.g==t)&&$n(n),!Ln(e))for(s=n.Fa.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(n.T=l[0],l=l[1],n.G==2)if(l[0]=="c"){n.I=l[1],n.ka=l[2];const u=l[3];u!=null&&(n.ma=u,n.j.info("VER="+n.ma));const d=l[4];d!=null&&(n.Ca=d,n.j.info("SVER="+n.Ca));const h=l[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var i=r.h;i.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(Rs(i,i.h),i.h=null))}if(r.D){const v=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(r.za=v,M(r.F,r.D,v))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms")),r=n;var o=t;if(r.sa=ec(r,r.H?r.ka:null,r.V),o.J){Va(r.h,o);var a=o,c=r.J;c&&a.setTimeout(c),a.B&&(ir(a),tn(a)),r.g=o}else Qa(r);0<n.i.length&&lr(n)}else l[0]!="stop"&&l[0]!="close"||qe(n,7);else n.G==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?qe(n,7):Ps(n):l[0]!="noop"&&n.l&&n.l.wa(l),n.A=0)}}$t(4)}catch{}}function Ph(t){if(t.W&&typeof t.W=="function")return t.W();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Xn(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function Fh(t){if(t.oa&&typeof t.oa=="function")return t.oa();if(!t.W||typeof t.W!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Xn(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function Na(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Xn(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=Fh(t),r=Ph(t),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}var xa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vh(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Ke(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ke){this.h=e!==void 0?e:t.h,Fn(this,t.j),this.s=t.s,this.g=t.g,Vn(this,t.m),this.l=t.l,e=t.i;var n=new Ut;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Li(this,n),this.o=t.o}else t&&(n=String(t).match(xa))?(this.h=!!e,Fn(this,n[1]||"",!0),this.s=St(n[2]||""),this.g=St(n[3]||"",!0),Vn(this,n[4]),this.l=St(n[5]||"",!0),Li(this,n[6]||"",!0),this.o=St(n[7]||"")):(this.h=!!e,this.i=new Ut(null,this.h))}Ke.prototype.toString=function(){var t=[],e=this.j;e&&t.push(It(e,Mi,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(It(e,Mi,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(It(n,n.charAt(0)=="/"?Bh:Uh,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",It(n,qh)),t.join("")};function Ie(t){return new Ke(t)}function Fn(t,e,n){t.j=n?St(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Vn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Li(t,e,n){e instanceof Ut?(t.i=e,Hh(t.i,t.h)):(n||(e=It(e,jh)),t.i=new Ut(e,t.h))}function M(t,e,n){t.i.set(e,n)}function or(t){return M(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function St(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function It(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,$h),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function $h(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Mi=/[#\/\?@]/g,Uh=/[#\?:]/g,Bh=/[#\?]/g,jh=/[#\?@]/g,qh=/#/g;function Ut(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ue(t){t.g||(t.g=new Map,t.h=0,t.i&&Vh(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}w=Ut.prototype;w.add=function(t,e){Ue(this),this.i=null,t=yt(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Ra(t,e){Ue(t),e=yt(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Oa(t,e){return Ue(t),e=yt(t,e),t.g.has(e)}w.forEach=function(t,e){Ue(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)};w.oa=function(){Ue(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let i=0;i<s.length;i++)n.push(e[r])}return n};w.W=function(t){Ue(this);let e=[];if(typeof t=="string")Oa(this,t)&&(e=e.concat(this.g.get(yt(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};w.set=function(t,e){return Ue(this),this.i=null,t=yt(this,t),Oa(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};w.get=function(t,e){return t?(t=this.W(t),0<t.length?String(t[0]):e):e};function La(t,e,n){Ra(t,e),0<n.length&&(t.i=null,t.g.set(yt(t,e),_s(n)),t.h+=n.length)}w.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),t.push(s)}}return this.i=t.join("&")};function yt(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Hh(t,e){e&&!t.j&&(Ue(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(Ra(this,r),La(this,s,n))},t)),t.j=e}var Kh=class{constructor(e,n){this.h=e,this.g=n}};function Ma(t){this.l=t||zh,I.PerformanceNavigationTiming?(t=I.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(I.g&&I.g.Ga&&I.g.Ga()&&I.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var zh=10;function Pa(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Fa(t){return t.h?1:t.g?t.g.size:0}function ns(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Rs(t,e){t.g?t.g.add(e):t.h=e}function Va(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Ma.prototype.cancel=function(){if(this.i=$a(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function $a(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return _s(t.i)}function Os(){}Os.prototype.stringify=function(t){return I.JSON.stringify(t,void 0)};Os.prototype.parse=function(t){return I.JSON.parse(t,void 0)};function Gh(){this.g=new Os}function Wh(t,e,n){const r=n||"";try{Na(t,function(s,i){let o=s;Xt(s)&&(o=Cs(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function Qh(t,e){const n=new tr;if(I.Image){const r=new Image;r.onload=fn(pn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=fn(pn,n,r,"TestLoadImage: error",!1,e),r.onabort=fn(pn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=fn(pn,n,r,"TestLoadImage: timeout",!1,e),I.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function pn(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function nn(t){this.l=t.ac||null,this.j=t.jb||!1}Y(nn,ks);nn.prototype.g=function(){return new ar(this.l,this.j)};nn.prototype.i=function(t){return function(){return t}}({});function ar(t,e){G.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Ls,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Y(ar,G);var Ls=0;w=ar.prototype;w.open=function(t,e){if(this.readyState!=Ls)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Bt(this)};w.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||I).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))};w.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,rn(this)),this.readyState=Ls};w.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Bt(this)),this.g&&(this.readyState=3,Bt(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof I.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ua(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))};function Ua(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}w.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?rn(this):Bt(this),this.readyState==3&&Ua(this)}};w.Va=function(t){this.g&&(this.response=this.responseText=t,rn(this))};w.Ua=function(t){this.g&&(this.response=t,rn(this))};w.ga=function(){this.g&&rn(this)};function rn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Bt(t)}w.setRequestHeader=function(t,e){this.v.append(t,e)};w.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};w.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Bt(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(ar.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var Xh=I.JSON.parse;function F(t){G.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Ba,this.K=this.L=!1}Y(F,G);var Ba="",Yh=/^https?$/i,Jh=["POST","PUT"];w=F.prototype;w.Ka=function(t){this.L=t};w.da=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Jr.g(),this.C=this.u?Oi(this.u):Oi(Jr),this.g.onreadystatechange=ne(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){Pi(this,i);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=I.FormData&&t instanceof I.FormData,!(0<=ra(Jh,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Ha(this),0<this.B&&((this.K=Zh(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ne(this.qa,this)):this.A=Ds(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){Pi(this,i)}};function Zh(t){return ct&&gh()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}w.qa=function(){typeof vs<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,X(this,"timeout"),this.abort(8))};function Pi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,ja(t),cr(t)}function ja(t){t.D||(t.D=!0,X(t,"complete"),X(t,"error"))}w.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,X(this,"complete"),X(this,"abort"),cr(this))};w.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),cr(this,!0)),F.X.M.call(this)};w.Ha=function(){this.s||(this.F||this.v||this.l?qa(this):this.fb())};w.fb=function(){qa(this)};function qa(t){if(t.h&&typeof vs<"u"&&(!t.C[1]||Te(t)!=4||t.aa()!=2)){if(t.v&&Te(t)==4)Ds(t.Ha,0,t);else if(X(t,"readystatechange"),Te(t)==4){t.h=!1;try{const a=t.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.H).match(xa)[1]||null;if(!s&&I.self&&I.self.location){var i=I.self.location.protocol;s=i.substr(0,i.length-1)}r=!Yh.test(s?s.toLowerCase():"")}n=r}if(n)X(t,"complete"),X(t,"success");else{t.m=6;try{var o=2<Te(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.aa()+"]",ja(t)}}finally{cr(t)}}}}function cr(t,e){if(t.g){Ha(t);const n=t.g,r=t.C[0]?On:null;t.g=null,t.C=null,e||X(t,"ready");try{n.onreadystatechange=r}catch{}}}function Ha(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(I.clearTimeout(t.A),t.A=null)}function Te(t){return t.g?t.g.readyState:0}w.aa=function(){try{return 2<Te(this)?this.g.status:-1}catch{return-1}};w.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}};w.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),Xh(e)}};function Fi(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Ba:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}w.Ea=function(){return this.m};w.Oa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Ka(t){let e="";return Es(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Ms(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Ka(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):M(t,e,n))}function Tt(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function za(t){this.Ca=0,this.i=[],this.j=new tr,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Tt("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Tt("baseRetryDelayMs",5e3,t),this.bb=Tt("retryDelaySeedMs",1e4,t),this.$a=Tt("forwardChannelMaxRetries",2,t),this.ta=Tt("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new Ma(t&&t.concurrentRequestLimit),this.Fa=new Gh,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}w=za.prototype;w.ma=8;w.G=1;function Ps(t){if(Ga(t),t.G==3){var e=t.U++,n=Ie(t.F);M(n,"SID",t.I),M(n,"RID",e),M(n,"TYPE","terminate"),sn(t,n),e=new en(t,t.j,e,void 0),e.K=2,e.v=or(Ie(n)),n=!1,I.navigator&&I.navigator.sendBeacon&&(n=I.navigator.sendBeacon(e.v.toString(),"")),!n&&I.Image&&(new Image().src=e.v,n=!0),n||(e.g=tc(e.l,null),e.g.da(e.v)),e.F=Date.now(),tn(e)}Za(t)}function ur(t){t.g&&(Vs(t),t.g.cancel(),t.g=null)}function Ga(t){ur(t),t.u&&(I.clearTimeout(t.u),t.u=null),$n(t),t.h.cancel(),t.m&&(typeof t.m=="number"&&I.clearTimeout(t.m),t.m=null)}function lr(t){Pa(t.h)||t.m||(t.m=!0,ma(t.Ja,t),t.C=0)}function ef(t,e){return Fa(t.h)>=t.h.j-(t.m?1:0)?!1:t.m?(t.i=e.D.concat(t.i),!0):t.G==1||t.G==2||t.C>=(t.Za?0:t.$a)?!1:(t.m=Jt(ne(t.Ja,t,e),Ja(t,t.C)),t.C++,!0)}w.Ja=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const s=new en(this,this.j,t,void 0);let i=this.s;if(this.S&&(i?(i=aa(i),ca(i,this.S)):i=this.S),this.o!==null||this.N||(s.H=i,i=null),this.O)e:{for(var e=0,n=0;n<this.i.length;n++){t:{var r=this.i[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.i.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=Wa(this,s,e),n=Ie(this.F),M(n,"RID",t),M(n,"CVER",22),this.D&&M(n,"X-HTTP-Session-Id",this.D),sn(this,n),i&&(this.N?e="headers="+encodeURIComponent(String(Ka(i)))+"&"+e:this.o&&Ms(n,this.o,i)),Rs(this.h,s),this.Ya&&M(n,"TYPE","init"),this.O?(M(n,"$req",e),M(n,"SID","null"),s.Z=!0,es(s,n,null)):es(s,n,e),this.G=2}}else this.G==3&&(t?Vi(this,t):this.i.length==0||Pa(this.h)||Vi(this))};function Vi(t,e){var n;e?n=e.m:n=t.U++;const r=Ie(t.F);M(r,"SID",t.I),M(r,"RID",n),M(r,"AID",t.T),sn(t,r),t.o&&t.s&&Ms(r,t.o,t.s),n=new en(t,t.j,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=Wa(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),Rs(t.h,n),es(n,r,e)}function sn(t,e){t.ia&&Es(t.ia,function(n,r){M(e,r,n)}),t.l&&Na({},function(n,r){M(e,r,n)})}function Wa(t,e,n){n=Math.min(t.i.length,n);var r=t.l?ne(t.l.Ra,t.l,t):null;e:{var s=t.i;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let l=s[c].h;const u=s[c].g;if(l-=i,0>l)i=Math.max(0,s[c].h-100),a=!1;else try{Wh(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.i.splice(0,n),e.D=t,r}function Qa(t){t.g||t.u||(t.Z=1,ma(t.Ia,t),t.A=0)}function Fs(t){return t.g||t.u||3<=t.A?!1:(t.Z++,t.u=Jt(ne(t.Ia,t),Ja(t,t.A)),t.A++,!0)}w.Ia=function(){if(this.u=null,Xa(this),this.$&&!(this.K||this.g==null||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=Jt(ne(this.eb,this),t)}};w.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,ae(10),ur(this),Xa(this))};function Vs(t){t.B!=null&&(I.clearTimeout(t.B),t.B=null)}function Xa(t){t.g=new en(t,t.j,"rpc",t.Z),t.o===null&&(t.g.H=t.s),t.g.N=0;var e=Ie(t.sa);M(e,"RID","rpc"),M(e,"SID",t.I),M(e,"CI",t.L?"0":"1"),M(e,"AID",t.T),M(e,"TYPE","xmlhttp"),sn(t,e),t.o&&t.s&&Ms(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=or(Ie(e)),n.s=null,n.P=!0,Ca(n,t)}w.cb=function(){this.v!=null&&(this.v=null,ur(this),Fs(this),ae(19))};function $n(t){t.v!=null&&(I.clearTimeout(t.v),t.v=null)}function Ya(t,e){var n=null;if(t.g==e){$n(t),Vs(t),t.g=null;var r=2}else if(ns(t.h,e))n=e.D,Va(t.h,e),r=1;else return;if(t.G!=0){if(t.pa=e.Y,e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;r=nr(),X(r,new ba(r,n)),lr(t)}else Qa(t);else if(s=e.o,s==3||s==0&&0<t.pa||!(r==1&&ef(t,e)||r==2&&Fs(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),s){case 1:qe(t,5);break;case 4:qe(t,10);break;case 3:qe(t,6);break;default:qe(t,2)}}}function Ja(t,e){let n=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(n*=2),n*e}function qe(t,e){if(t.j.info("Error code "+e),e==2){var n=null;t.l&&(n=null);var r=ne(t.kb,t);n||(n=new Ke("//www.google.com/images/cleardot.gif"),I.location&&I.location.protocol=="http"||Fn(n,"https"),or(n)),Qh(n.toString(),r)}else ae(2);t.G=0,t.l&&t.l.va(e),Za(t),Ga(t)}w.kb=function(t){t?(this.j.info("Successfully pinged google.com"),ae(2)):(this.j.info("Failed to ping google.com"),ae(1))};function Za(t){if(t.G=0,t.la=[],t.l){const e=$a(t.h);(e.length!=0||t.i.length!=0)&&(Ai(t.la,e),Ai(t.la,t.i),t.h.i.length=0,_s(t.i),t.i.length=0),t.l.ua()}}function ec(t,e,n){var r=n instanceof Ke?Ie(n):new Ke(n,void 0);if(r.g!="")e&&(r.g=e+"."+r.g),Vn(r,r.m);else{var s=I.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new Ke(null,void 0);r&&Fn(i,r),e&&(i.g=e),s&&Vn(i,s),n&&(i.l=n),r=i}return n=t.D,e=t.za,n&&e&&M(r,n,e),M(r,"VER",t.ma),sn(t,r),r}function tc(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Da&&!t.ra?new F(new nn({jb:!0})):new F(t.ra),e.Ka(t.H),e}function nc(){}w=nc.prototype;w.xa=function(){};w.wa=function(){};w.va=function(){};w.ua=function(){};w.Ra=function(){};function Un(){if(ct&&!(10<=Number(yh)))throw Error("Environmental error: no available transport.")}Un.prototype.g=function(t,e){return new ue(t,e)};function ue(t,e){G.call(this),this.g=new za(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!Ln(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ln(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new vt(this)}Y(ue,G);ue.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;ae(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=ec(t,null,t.V),lr(t)};ue.prototype.close=function(){Ps(this.g)};ue.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Cs(t),t=n);e.i.push(new Kh(e.ab++,t)),e.G==3&&lr(e)};ue.prototype.M=function(){this.g.l=null,delete this.j,Ps(this.g),delete this.g,ue.X.M.call(this)};function rc(t){Ns.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Y(rc,Ns);function sc(){xs.call(this),this.status=1}Y(sc,xs);function vt(t){this.g=t}Y(vt,nc);vt.prototype.xa=function(){X(this.g,"a")};vt.prototype.wa=function(t){X(this.g,new rc(t))};vt.prototype.va=function(t){X(this.g,new sc)};vt.prototype.ua=function(){X(this.g,"b")};Un.prototype.createWebChannel=Un.prototype.g;ue.prototype.send=ue.prototype.u;ue.prototype.open=ue.prototype.m;ue.prototype.close=ue.prototype.close;rr.NO_ERROR=0;rr.TIMEOUT=8;rr.HTTP_ERROR=6;Ta.COMPLETE="complete";Sa.EventType=Zt;Zt.OPEN="a";Zt.CLOSE="b";Zt.ERROR="c";Zt.MESSAGE="d";G.prototype.listen=G.prototype.N;F.prototype.listenOnce=F.prototype.O;F.prototype.getLastError=F.prototype.Oa;F.prototype.getLastErrorCode=F.prototype.Ea;F.prototype.getStatus=F.prototype.aa;F.prototype.getResponseJson=F.prototype.Sa;F.prototype.getResponseText=F.prototype.fa;F.prototype.send=F.prototype.da;F.prototype.setWithCredentials=F.prototype.Ka;var tf=function(){return new Un},nf=function(){return nr()},Or=rr,rf=Ta,sf=Xe,$i={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},of=nn,mn=Sa,af=F;const Ui="@firebase/firestore";class Z{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Z.UNAUTHENTICATED=new Z(null),Z.GOOGLE_CREDENTIALS=new Z("google-credentials-uid"),Z.FIRST_PARTY=new Z("first-party-uid"),Z.MOCK_USER=new Z("mock-user");let _t="9.15.0";const We=new Yo("@firebase/firestore");function Bi(){return We.logLevel}function b(t,...e){if(We.logLevel<=R.DEBUG){const n=e.map($s);We.debug(`Firestore (${_t}): ${t}`,...n)}}function Ce(t,...e){if(We.logLevel<=R.ERROR){const n=e.map($s);We.error(`Firestore (${_t}): ${t}`,...n)}}function rs(t,...e){if(We.logLevel<=R.WARN){const n=e.map($s);We.warn(`Firestore (${_t}): ${t}`,...n)}}function $s(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}var e}function C(t="Unexpected state"){const e=`FIRESTORE (${_t}) INTERNAL ASSERTION FAILED: `+t;throw Ce(e),new Error(e)}function L(t,e){t||C()}function D(t,e){return t}const g={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};let S=class extends gt{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};class Me{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}let ic=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},cf=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Z.UNAUTHENTICATED))}shutdown(){}},uf=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},lf=class{constructor(e){this.t=e,this.currentUser=Z.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Me;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Me,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{b("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(b("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Me)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(b("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(L(typeof r.accessToken=="string"),new ic(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return L(e===null||typeof e=="string"),new Z(e)}},hf=class{constructor(e,n,r,s){this.h=e,this.l=n,this.m=r,this.g=s,this.type="FirstParty",this.user=Z.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(L(!(typeof this.h!="object"||this.h===null||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}},ff=class{constructor(e,n,r,s){this.h=e,this.l=n,this.m=r,this.g=s}getToken(){return Promise.resolve(new hf(this.h,this.l,this.m,this.g))}start(e,n){e.enqueueRetryable(()=>n(Z.FIRST_PARTY))}shutdown(){}invalidateToken(){}},df=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},pf=class{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,n){const r=i=>{i.error!=null&&b("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,b("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{b("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?s(i):b("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(L(typeof n.token=="string"),this.A=n.token,new df(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function mf(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class oc{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=mf(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function O(t,e){return t<e?-1:t>e?1:0}function ut(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}class j{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new S(g.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new S(g.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new S(g.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new S(g.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return j.fromMillis(Date.now())}static fromDate(e){return j.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new j(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?O(this.nanoseconds,e.nanoseconds):O(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class A{constructor(e){this.timestamp=e}static fromTimestamp(e){return new A(e)}static min(){return new A(new j(0,0))}static max(){return new A(new j(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class jt{constructor(e,n,r){n===void 0?n=0:n>e.length&&C(),r===void 0?r=e.length-n:r>e.length-n&&C(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return jt.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof jt?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class P extends jt{construct(e,n,r){return new P(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new S(g.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new P(n)}static emptyPath(){return new P([])}}const gf=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class te extends jt{construct(e,n,r){return new te(e,n,r)}static isValidIdentifier(e){return gf.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),te.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new te(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new S(g.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new S(g.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new S(g.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new S(g.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new te(n)}static emptyPath(){return new te([])}}class T{constructor(e){this.path=e}static fromPath(e){return new T(P.fromString(e))}static fromName(e){return new T(P.fromString(e).popFirst(5))}static empty(){return new T(P.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&P.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return P.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new T(new P(e.slice()))}}function yf(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=A.fromTimestamp(r===1e9?new j(n+1,0):new j(n,r));return new Pe(s,T.empty(),e)}function vf(t){return new Pe(t.readTime,t.key,-1)}class Pe{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Pe(A.min(),T.empty(),-1)}static max(){return new Pe(A.max(),T.empty(),-1)}}function _f(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=T.comparator(t.documentKey,e.documentKey),n!==0?n:O(t.largestBatchId,e.largestBatchId))}const wf="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ef{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function on(t){if(t.code!==g.FAILED_PRECONDITION||t.message!==wf)throw t;b("LocalStore","Unexpectedly lost primary lease")}class m{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&C(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new m((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof m?n:m.resolve(n)}catch(n){return m.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):m.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):m.reject(n)}static resolve(e){return new m((n,r)=>{n(e)})}static reject(e){return new m((n,r)=>{r(e)})}static waitFor(e){return new m((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=m.resolve(!1);for(const r of e)n=n.next(s=>s?m.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new m((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new m((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function an(t){return t.name==="IndexedDbTransactionError"}class Us{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>n.writeSequenceNumber(r))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}Us.at=-1;class bf{constructor(e,n,r,s,i,o,a,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}}class qt{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new qt("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof qt&&e.projectId===this.projectId&&e.database===this.database}}function ji(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function wt(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ac(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function hr(t){return t==null}function Bn(t){return t===0&&1/t==-1/0}function Tf(t){return typeof t=="number"&&Number.isInteger(t)&&!Bn(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}class se{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new se(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new se(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return O(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}se.EMPTY_BYTE_STRING=new se("");const Sf=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fe(t){if(L(!!t),typeof t=="string"){let e=0;const n=Sf.exec(t);if(L(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$(t.seconds),nanos:$(t.nanos)}}function $(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function lt(t){return typeof t=="string"?se.fromBase64String(t):se.fromUint8Array(t)}function cc(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function uc(t){const e=t.mapValue.fields.__previous_value__;return cc(e)?uc(e):e}function Ht(t){const e=Fe(t.mapValue.fields.__local_write_time__.timestampValue);return new j(e.seconds,e.nanos)}const gn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Qe(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?cc(t)?4:If(t)?9007199254740991:10:C()}function _e(t,e){if(t===e)return!0;const n=Qe(t);if(n!==Qe(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ht(t).isEqual(Ht(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=Fe(r.timestampValue),o=Fe(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return lt(r.bytesValue).isEqual(lt(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return $(r.geoPointValue.latitude)===$(s.geoPointValue.latitude)&&$(r.geoPointValue.longitude)===$(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return $(r.integerValue)===$(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=$(r.doubleValue),o=$(s.doubleValue);return i===o?Bn(i)===Bn(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return ut(t.arrayValue.values||[],e.arrayValue.values||[],_e);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(ji(i)!==ji(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!_e(i[a],o[a])))return!1;return!0}(t,e);default:return C()}}function Kt(t,e){return(t.values||[]).find(n=>_e(n,e))!==void 0}function ht(t,e){if(t===e)return 0;const n=Qe(t),r=Qe(e);if(n!==r)return O(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return O(t.booleanValue,e.booleanValue);case 2:return function(s,i){const o=$(s.integerValue||s.doubleValue),a=$(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return qi(t.timestampValue,e.timestampValue);case 4:return qi(Ht(t),Ht(e));case 5:return O(t.stringValue,e.stringValue);case 6:return function(s,i){const o=lt(s),a=lt(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=O(o[c],a[c]);if(l!==0)return l}return O(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const o=O($(s.latitude),$(i.latitude));return o!==0?o:O($(s.longitude),$(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=ht(o[c],a[c]);if(l)return l}return O(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===gn.mapValue&&i===gn.mapValue)return 0;if(s===gn.mapValue)return 1;if(i===gn.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),c=i.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let u=0;u<a.length&&u<l.length;++u){const d=O(a[u],l[u]);if(d!==0)return d;const h=ht(o[a[u]],c[l[u]]);if(h!==0)return h}return O(a.length,l.length)}(t.mapValue,e.mapValue);default:throw C()}}function qi(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return O(t,e);const n=Fe(t),r=Fe(e),s=O(n.seconds,r.seconds);return s!==0?s:O(n.nanos,r.nanos)}function ft(t){return ss(t)}function ss(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=Fe(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?lt(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,T.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=ss(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${ss(r.fields[a])}`;return i+"}"}(t.mapValue):C();var e,n}function is(t){return!!t&&"integerValue"in t}function Bs(t){return!!t&&"arrayValue"in t}function Hi(t){return!!t&&"nullValue"in t}function Ki(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function wn(t){return!!t&&"mapValue"in t}function Nt(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return wt(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Nt(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Nt(t.arrayValue.values[n]);return e}return Object.assign({},t)}function If(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}class jn{constructor(e,n){this.position=e,this.inclusive=n}}function zi(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=T.comparator(T.fromName(o.referenceValue),n.key):r=ht(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Gi(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!_e(t.position[n],e.position[n]))return!1;return!0}class lc{}class B extends lc{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Df(e,n,r):n==="array-contains"?new xf(e,r):n==="in"?new Rf(e,r):n==="not-in"?new Of(e,r):n==="array-contains-any"?new Lf(e,r):new B(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new kf(e,r):new Nf(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ht(n,this.value)):n!==null&&Qe(this.value)===Qe(n)&&this.matchesComparison(ht(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return C()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class we extends lc{constructor(e,n){super(),this.filters=e,this.op=n,this.ht=null}static create(e,n){return new we(e,n)}matches(e){return hc(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ht!==null||(this.ht=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt(n=>n.isInequality());return e!==null?e.field:null}lt(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function hc(t){return t.op==="and"}function Cf(t){return Af(t)&&hc(t)}function Af(t){for(const e of t.filters)if(e instanceof we)return!1;return!0}function fc(t){if(t instanceof B)return t.field.canonicalString()+t.op.toString()+ft(t.value);{const e=t.filters.map(n=>fc(n)).join(",");return`${t.op}(${e})`}}function dc(t,e){return t instanceof B?function(n,r){return r instanceof B&&n.op===r.op&&n.field.isEqual(r.field)&&_e(n.value,r.value)}(t,e):t instanceof we?function(n,r){return r instanceof we&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((s,i,o)=>s&&dc(i,r.filters[o]),!0):!1}(t,e):void C()}function pc(t){return t instanceof B?function(e){return`${e.field.canonicalString()} ${e.op} ${ft(e.value)}`}(t):t instanceof we?function(e){return e.op.toString()+" {"+e.getFilters().map(pc).join(" ,")+"}"}(t):"Filter"}class Df extends B{constructor(e,n,r){super(e,n,r),this.key=T.fromName(r.referenceValue)}matches(e){const n=T.comparator(e.key,this.key);return this.matchesComparison(n)}}class kf extends B{constructor(e,n){super(e,"in",n),this.keys=mc("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Nf extends B{constructor(e,n){super(e,"not-in",n),this.keys=mc("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function mc(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>T.fromName(r.referenceValue))}class xf extends B{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Bs(n)&&Kt(n.arrayValue,this.value)}}class Rf extends B{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Kt(this.value.arrayValue,n)}}class Of extends B{constructor(e,n){super(e,"not-in",n)}matches(e){if(Kt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Kt(this.value.arrayValue,n)}}class Lf extends B{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Bs(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Kt(this.value.arrayValue,r))}}class xt{constructor(e,n="asc"){this.field=e,this.dir=n}}function Mf(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class H{constructor(e,n){this.comparator=e,this.root=n||Q.EMPTY}insert(e,n){return new H(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Q.BLACK,null,null))}remove(e){return new H(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Q.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yn(this.root,e,this.comparator,!1)}getReverseIterator(){return new yn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yn(this.root,e,this.comparator,!0)}}class yn{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Q{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Q.RED,this.left=s??Q.EMPTY,this.right=i??Q.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Q(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Q.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Q.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Q.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Q.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw C();const e=this.left.check();if(e!==this.right.check())throw C();return e+(this.isRed()?0:1)}}Q.EMPTY=null,Q.RED=!0,Q.BLACK=!1;Q.EMPTY=new class{constructor(){this.size=0}get key(){throw C()}get value(){throw C()}get color(){throw C()}get left(){throw C()}get right(){throw C()}copy(t,e,n,r,s){return this}insert(t,e,n){return new Q(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class q{constructor(e){this.comparator=e,this.data=new H(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Wi(this.data.getIterator())}getIteratorFrom(e){return new Wi(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof q)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new q(this.comparator);return n.data=e,n}}class Wi{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ge{constructor(e){this.fields=e,e.sort(te.comparator)}static empty(){return new ge([])}unionWith(e){let n=new q(te.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new ge(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ut(this.fields,e.fields,(n,r)=>n.isEqual(r))}}class le{constructor(e){this.value=e}static empty(){return new le({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!wn(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nt(n)}setAll(e){let n=te.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Nt(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());wn(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return _e(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];wn(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){wt(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new le(Nt(this.value))}}function gc(t){const e=[];return wt(t.fields,(n,r)=>{const s=new te([n]);if(wn(r)){const i=gc(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new ge(e)}class ee{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ee(e,0,A.min(),A.min(),A.min(),le.empty(),0)}static newFoundDocument(e,n,r,s){return new ee(e,1,n,A.min(),r,s,0)}static newNoDocument(e,n){return new ee(e,2,n,A.min(),A.min(),le.empty(),0)}static newUnknownDocument(e,n){return new ee(e,3,n,A.min(),A.min(),le.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(A.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=le.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=le.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=A.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ee&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ee(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}let Pf=class{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ft=null}};function Qi(t,e=null,n=[],r=[],s=null,i=null,o=null){return new Pf(t,e,n,r,s,i,o)}function js(t){const e=D(t);if(e.ft===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>fc(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),hr(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ft(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ft(r)).join(",")),e.ft=n}return e.ft}function qs(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Mf(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!dc(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Gi(t.startAt,e.startAt)&&Gi(t.endAt,e.endAt)}function os(t){return T.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class fr{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.dt=null,this._t=null,this.startAt,this.endAt}}function Ff(t,e,n,r,s,i,o,a){return new fr(t,e,n,r,s,i,o,a)}function Hs(t){return new fr(t)}function Xi(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Vf(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function $f(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function Uf(t){return t.collectionGroup!==null}function ot(t){const e=D(t);if(e.dt===null){e.dt=[];const n=$f(e),r=Vf(e);if(n!==null&&r===null)n.isKeyField()||e.dt.push(new xt(n)),e.dt.push(new xt(te.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.dt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new xt(te.keyField(),i))}}}return e.dt}function Ae(t){const e=D(t);if(!e._t)if(e.limitType==="F")e._t=Qi(e.path,e.collectionGroup,ot(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of ot(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new xt(i.field,o))}const r=e.endAt?new jn(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new jn(e.startAt.position,e.startAt.inclusive):null;e._t=Qi(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e._t}function as(t,e,n){return new fr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function dr(t,e){return qs(Ae(t),Ae(e))&&t.limitType===e.limitType}function yc(t){return`${js(Ae(t))}|lt:${t.limitType}`}function cs(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(r=>pc(r)).join(", ")}]`),hr(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(r=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(r)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ft(r)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ft(r)).join(",")),`Target(${n})`}(Ae(t))}; limitType=${t.limitType})`}function Ks(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):T.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of ot(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,o){const a=zi(s,i,o);return s.inclusive?a<=0:a<0}(n.startAt,ot(n),r)||n.endAt&&!function(s,i,o){const a=zi(s,i,o);return s.inclusive?a>=0:a>0}(n.endAt,ot(n),r))}(t,e)}function Bf(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function vc(t){return(e,n)=>{let r=!1;for(const s of ot(t)){const i=jf(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function jf(t,e,n){const r=t.field.isKeyField()?T.comparator(e.key,n.key):function(s,i,o){const a=i.data.field(s),c=o.data.field(s);return a!==null&&c!==null?ht(a,c):C()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return C()}}function _c(t,e){if(t.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bn(e)?"-0":e}}function wc(t){return{integerValue:""+t}}function qf(t,e){return Tf(e)?wc(e):_c(t,e)}class pr{constructor(){this._=void 0}}function Hf(t,e,n){return t instanceof qn?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof zt?bc(t,e):t instanceof Gt?Tc(t,e):function(r,s){const i=Ec(r,s),o=Yi(i)+Yi(r.gt);return is(i)&&is(r.gt)?wc(o):_c(r.yt,o)}(t,e)}function Kf(t,e,n){return t instanceof zt?bc(t,e):t instanceof Gt?Tc(t,e):n}function Ec(t,e){return t instanceof Hn?is(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class qn extends pr{}class zt extends pr{constructor(e){super(),this.elements=e}}function bc(t,e){const n=Sc(e);for(const r of t.elements)n.some(s=>_e(s,r))||n.push(r);return{arrayValue:{values:n}}}class Gt extends pr{constructor(e){super(),this.elements=e}}function Tc(t,e){let n=Sc(e);for(const r of t.elements)n=n.filter(s=>!_e(s,r));return{arrayValue:{values:n}}}class Hn extends pr{constructor(e,n){super(),this.yt=e,this.gt=n}}function Yi(t){return $(t.integerValue||t.doubleValue)}function Sc(t){return Bs(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function zf(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof zt&&r instanceof zt||n instanceof Gt&&r instanceof Gt?ut(n.elements,r.elements,_e):n instanceof Hn&&r instanceof Hn?_e(n.gt,r.gt):n instanceof qn&&r instanceof qn}(t.transform,e.transform)}class Gf{constructor(e,n){this.version=e,this.transformResults=n}}class Se{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Se}static exists(e){return new Se(void 0,e)}static updateTime(e){return new Se(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function En(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class mr{}function Ic(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ac(t.key,Se.none()):new cn(t.key,t.data,Se.none());{const n=t.data,r=le.empty();let s=new q(te.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Ye(t.key,r,new ge(s.toArray()),Se.none())}}function Wf(t,e,n){t instanceof cn?function(r,s,i){const o=r.value.clone(),a=Zi(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Ye?function(r,s,i){if(!En(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=Zi(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(Cc(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function Rt(t,e,n,r){return t instanceof cn?function(s,i,o,a){if(!En(s.precondition,i))return o;const c=s.value.clone(),l=eo(s.fieldTransforms,a,i);return c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ye?function(s,i,o,a){if(!En(s.precondition,i))return o;const c=eo(s.fieldTransforms,a,i),l=i.data;return l.setAll(Cc(s)),l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(t,e,n,r):function(s,i,o){return En(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function Qf(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Ec(r.transform,s||null);i!=null&&(n===null&&(n=le.empty()),n.set(r.field,i))}return n||null}function Ji(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&ut(n,r,(s,i)=>zf(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class cn extends mr{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ye extends mr{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Cc(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Zi(t,e,n){const r=new Map;L(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,Kf(o,a,n[s]))}return r}function eo(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Hf(i,o,e))}return r}class Ac extends mr{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xf extends mr{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Yf{constructor(e){this.count=e}}var V,x;function Jf(t){switch(t){default:return C();case g.CANCELLED:case g.UNKNOWN:case g.DEADLINE_EXCEEDED:case g.RESOURCE_EXHAUSTED:case g.INTERNAL:case g.UNAVAILABLE:case g.UNAUTHENTICATED:return!1;case g.INVALID_ARGUMENT:case g.NOT_FOUND:case g.ALREADY_EXISTS:case g.PERMISSION_DENIED:case g.FAILED_PRECONDITION:case g.ABORTED:case g.OUT_OF_RANGE:case g.UNIMPLEMENTED:case g.DATA_LOSS:return!0}}function Dc(t){if(t===void 0)return Ce("GRPC error has no .code"),g.UNKNOWN;switch(t){case V.OK:return g.OK;case V.CANCELLED:return g.CANCELLED;case V.UNKNOWN:return g.UNKNOWN;case V.DEADLINE_EXCEEDED:return g.DEADLINE_EXCEEDED;case V.RESOURCE_EXHAUSTED:return g.RESOURCE_EXHAUSTED;case V.INTERNAL:return g.INTERNAL;case V.UNAVAILABLE:return g.UNAVAILABLE;case V.UNAUTHENTICATED:return g.UNAUTHENTICATED;case V.INVALID_ARGUMENT:return g.INVALID_ARGUMENT;case V.NOT_FOUND:return g.NOT_FOUND;case V.ALREADY_EXISTS:return g.ALREADY_EXISTS;case V.PERMISSION_DENIED:return g.PERMISSION_DENIED;case V.FAILED_PRECONDITION:return g.FAILED_PRECONDITION;case V.ABORTED:return g.ABORTED;case V.OUT_OF_RANGE:return g.OUT_OF_RANGE;case V.UNIMPLEMENTED:return g.UNIMPLEMENTED;case V.DATA_LOSS:return g.DATA_LOSS;default:return C()}}(x=V||(V={}))[x.OK=0]="OK",x[x.CANCELLED=1]="CANCELLED",x[x.UNKNOWN=2]="UNKNOWN",x[x.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",x[x.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",x[x.NOT_FOUND=5]="NOT_FOUND",x[x.ALREADY_EXISTS=6]="ALREADY_EXISTS",x[x.PERMISSION_DENIED=7]="PERMISSION_DENIED",x[x.UNAUTHENTICATED=16]="UNAUTHENTICATED",x[x.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",x[x.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",x[x.ABORTED=10]="ABORTED",x[x.OUT_OF_RANGE=11]="OUT_OF_RANGE",x[x.UNIMPLEMENTED=12]="UNIMPLEMENTED",x[x.INTERNAL=13]="INTERNAL",x[x.UNAVAILABLE=14]="UNAVAILABLE",x[x.DATA_LOSS=15]="DATA_LOSS";class Et{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){wt(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return ac(this.inner)}size(){return this.innerSize}}const Zf=new H(T.comparator);function De(){return Zf}const kc=new H(T.comparator);function Ct(...t){let e=kc;for(const n of t)e=e.insert(n.key,n);return e}function Nc(t){let e=kc;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function He(){return Ot()}function xc(){return Ot()}function Ot(){return new Et(t=>t.toString(),(t,e)=>t.isEqual(e))}const ed=new H(T.comparator),td=new q(T.comparator);function N(...t){let e=td;for(const n of t)e=e.add(n);return e}const nd=new q(O);function Rc(){return nd}class gr{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,un.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new gr(A.min(),s,Rc(),De(),N())}}class un{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new un(r,n,N(),N(),N())}}class bn{constructor(e,n,r,s){this.It=e,this.removedTargetIds=n,this.key=r,this.Tt=s}}class Oc{constructor(e,n){this.targetId=e,this.Et=n}}class Lc{constructor(e,n,r=se.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class to{constructor(){this.At=0,this.Rt=ro(),this.bt=se.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}get current(){return this.Pt}get resumeToken(){return this.bt}get Vt(){return this.At!==0}get St(){return this.vt}Dt(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}Ct(){let e=N(),n=N(),r=N();return this.Rt.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:C()}}),new un(this.bt,this.Pt,e,n,r)}xt(){this.vt=!1,this.Rt=ro()}Nt(e,n){this.vt=!0,this.Rt=this.Rt.insert(e,n)}kt(e){this.vt=!0,this.Rt=this.Rt.remove(e)}Ot(){this.At+=1}Mt(){this.At-=1}Ft(){this.vt=!0,this.Pt=!0}}class rd{constructor(e){this.$t=e,this.Bt=new Map,this.Lt=De(),this.qt=no(),this.Ut=new q(O)}Kt(e){for(const n of e.It)e.Tt&&e.Tt.isFoundDocument()?this.Gt(n,e.Tt):this.Qt(n,e.key,e.Tt);for(const n of e.removedTargetIds)this.Qt(n,e.key,e.Tt)}jt(e){this.forEachTarget(e,n=>{const r=this.Wt(n);switch(e.state){case 0:this.zt(n)&&r.Dt(e.resumeToken);break;case 1:r.Mt(),r.Vt||r.xt(),r.Dt(e.resumeToken);break;case 2:r.Mt(),r.Vt||this.removeTarget(n);break;case 3:this.zt(n)&&(r.Ft(),r.Dt(e.resumeToken));break;case 4:this.zt(n)&&(this.Ht(n),r.Dt(e.resumeToken));break;default:C()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Bt.forEach((r,s)=>{this.zt(s)&&n(s)})}Jt(e){const n=e.targetId,r=e.Et.count,s=this.Yt(n);if(s){const i=s.target;if(os(i))if(r===0){const o=new T(i.path);this.Qt(n,o,ee.newNoDocument(o,A.min()))}else L(r===1);else this.Xt(n)!==r&&(this.Ht(n),this.Ut=this.Ut.add(n))}}Zt(e){const n=new Map;this.Bt.forEach((i,o)=>{const a=this.Yt(o);if(a){if(i.current&&os(a.target)){const c=new T(a.target.path);this.Lt.get(c)!==null||this.te(o,c)||this.Qt(o,c,ee.newNoDocument(c,e))}i.St&&(n.set(o,i.Ct()),i.xt())}});let r=N();this.qt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Yt(c);return!l||l.purpose===2||(a=!1,!1)}),a&&(r=r.add(i))}),this.Lt.forEach((i,o)=>o.setReadTime(e));const s=new gr(e,n,this.Ut,this.Lt,r);return this.Lt=De(),this.qt=no(),this.Ut=new q(O),s}Gt(e,n){if(!this.zt(e))return;const r=this.te(e,n.key)?2:0;this.Wt(e).Nt(n.key,r),this.Lt=this.Lt.insert(n.key,n),this.qt=this.qt.insert(n.key,this.ee(n.key).add(e))}Qt(e,n,r){if(!this.zt(e))return;const s=this.Wt(e);this.te(e,n)?s.Nt(n,1):s.kt(n),this.qt=this.qt.insert(n,this.ee(n).delete(e)),r&&(this.Lt=this.Lt.insert(n,r))}removeTarget(e){this.Bt.delete(e)}Xt(e){const n=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ot(e){this.Wt(e).Ot()}Wt(e){let n=this.Bt.get(e);return n||(n=new to,this.Bt.set(e,n)),n}ee(e){let n=this.qt.get(e);return n||(n=new q(O),this.qt=this.qt.insert(e,n)),n}zt(e){const n=this.Yt(e)!==null;return n||b("WatchChangeAggregator","Detected inactive target",e),n}Yt(e){const n=this.Bt.get(e);return n&&n.Vt?null:this.$t.ne(e)}Ht(e){this.Bt.set(e,new to),this.$t.getRemoteKeysForTarget(e).forEach(n=>{this.Qt(e,n,null)})}te(e,n){return this.$t.getRemoteKeysForTarget(e).has(n)}}function no(){return new H(T.comparator)}function ro(){return new H(T.comparator)}const sd=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),id=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),od=(()=>({and:"AND",or:"OR"}))();class ad{constructor(e,n){this.databaseId=e,this.wt=n}}function Kn(t,e){return t.wt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mc(t,e){return t.wt?e.toBase64():e.toUint8Array()}function cd(t,e){return Kn(t,e.toTimestamp())}function ye(t){return L(!!t),A.fromTimestamp(function(e){const n=Fe(e);return new j(n.seconds,n.nanos)}(t))}function zs(t,e){return function(n){return new P(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function Pc(t){const e=P.fromString(t);return L(Uc(e)),e}function us(t,e){return zs(t.databaseId,e.path)}function Lr(t,e){const n=Pc(e);if(n.get(1)!==t.databaseId.projectId)throw new S(g.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new S(g.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new T(Fc(n))}function ls(t,e){return zs(t.databaseId,e)}function ud(t){const e=Pc(t);return e.length===4?P.emptyPath():Fc(e)}function hs(t){return new P(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Fc(t){return L(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function so(t,e,n){return{name:us(t,e),fields:n.value.mapValue.fields}}function ld(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:C()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,l){return c.wt?(L(l===void 0||typeof l=="string"),se.fromBase64String(l||"")):(L(l===void 0||l instanceof Uint8Array),se.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=c.code===void 0?g.UNKNOWN:Dc(c.code);return new S(l,c.message||"")}(o);n=new Lc(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Lr(t,r.document.name),i=ye(r.document.updateTime),o=r.document.createTime?ye(r.document.createTime):A.min(),a=new le({mapValue:{fields:r.document.fields}}),c=ee.newFoundDocument(s,i,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new bn(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Lr(t,r.document),i=r.readTime?ye(r.readTime):A.min(),o=ee.newNoDocument(s,i),a=r.removedTargetIds||[];n=new bn([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Lr(t,r.document),i=r.removedTargetIds||[];n=new bn([],i,s,null)}else{if(!("filter"in e))return C();{e.filter;const r=e.filter;r.targetId;const s=r.count||0,i=new Yf(s),o=r.targetId;n=new Oc(o,i)}}return n}function hd(t,e){let n;if(e instanceof cn)n={update:so(t,e.key,e.value)};else if(e instanceof Ac)n={delete:us(t,e.key)};else if(e instanceof Ye)n={update:so(t,e.key,e.data),updateMask:wd(e.fieldMask)};else{if(!(e instanceof Xf))return C();n={verify:us(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof qn)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof zt)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Gt)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Hn)return{fieldPath:i.field.canonicalString(),increment:o.gt};throw C()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:cd(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:C()}(t,e.precondition)),n}function fd(t,e){return t&&t.length>0?(L(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?ye(r.updateTime):ye(s);return i.isEqual(A.min())&&(i=ye(s)),new Gf(i,r.transformResults||[])}(n,e))):[]}function dd(t,e){return{documents:[ls(t,e.path)]}}function pd(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=ls(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ls(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(c){if(c.length!==0)return $c(we.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const i=function(c){if(c.length!==0)return c.map(l=>function(u){return{field:tt(u.field),direction:yd(u.dir)}}(l))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(c,l){return c.wt||hr(l)?l:{value:l}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function md(t){let e=ud(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){L(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=function(u){const d=Vc(u);return d instanceof we&&Cf(d)?d.getFilters():[d]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(d){return new xt(nt(d.field),function(h){switch(h){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction))}(u)));let a=null;n.limit&&(a=function(u){let d;return d=typeof u=="object"?u.value:u,hr(d)?null:d}(n.limit));let c=null;n.startAt&&(c=function(u){const d=!!u.before,h=u.values||[];return new jn(h,d)}(n.startAt));let l=null;return n.endAt&&(l=function(u){const d=!u.before,h=u.values||[];return new jn(h,d)}(n.endAt)),Ff(e,s,o,i,a,"F",c,l)}function gd(t,e){const n=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return C()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function Vc(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=nt(e.unaryFilter.field);return B.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=nt(e.unaryFilter.field);return B.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=nt(e.unaryFilter.field);return B.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=nt(e.unaryFilter.field);return B.create(i,"!=",{nullValue:"NULL_VALUE"});default:return C()}}(t):t.fieldFilter!==void 0?function(e){return B.create(nt(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return C()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return we.create(e.compositeFilter.filters.map(n=>Vc(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return C()}}(e.compositeFilter.op))}(t):C()}function yd(t){return sd[t]}function vd(t){return id[t]}function _d(t){return od[t]}function tt(t){return{fieldPath:t.canonicalString()}}function nt(t){return te.fromServerFormat(t.fieldPath)}function $c(t){return t instanceof B?function(e){if(e.op==="=="){if(Ki(e.value))return{unaryFilter:{field:tt(e.field),op:"IS_NAN"}};if(Hi(e.value))return{unaryFilter:{field:tt(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Ki(e.value))return{unaryFilter:{field:tt(e.field),op:"IS_NOT_NAN"}};if(Hi(e.value))return{unaryFilter:{field:tt(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:tt(e.field),op:vd(e.op),value:e.value}}}(t):t instanceof we?function(e){const n=e.getFilters().map(r=>$c(r));return n.length===1?n[0]:{compositeFilter:{op:_d(e.op),filters:n}}}(t):C()}function wd(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Uc(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Ed{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Wf(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Rt(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Rt(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=xc();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=Ic(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(A.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),N())}isEqual(e){return this.batchId===e.batchId&&ut(this.mutations,e.mutations,(n,r)=>Ji(n,r))&&ut(this.baseMutations,e.baseMutations,(n,r)=>Ji(n,r))}}class Gs{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){L(e.mutations.length===r.length);let s=ed;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Gs(e,n,r,s)}}class bd{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class ze{constructor(e,n,r,s,i=A.min(),o=A.min(),a=se.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new ze(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new ze(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new ze(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Td{constructor(e){this.ie=e}}function Sd(t){const e=md({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?as(e,e.limit,"L"):e}class Id{constructor(){this.Je=new Cd}addToCollectionParentIndex(e,n){return this.Je.add(n),m.resolve()}getCollectionParents(e,n){return m.resolve(this.Je.getEntries(n))}addFieldIndex(e,n){return m.resolve()}deleteFieldIndex(e,n){return m.resolve()}getDocumentsMatchingTarget(e,n){return m.resolve(null)}getIndexType(e,n){return m.resolve(0)}getFieldIndexes(e,n){return m.resolve([])}getNextCollectionGroupToUpdate(e){return m.resolve(null)}getMinOffset(e,n){return m.resolve(Pe.min())}getMinOffsetFromCollectionGroup(e,n){return m.resolve(Pe.min())}updateCollectionGroup(e,n,r){return m.resolve()}updateIndexEntries(e,n){return m.resolve()}}class Cd{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new q(P.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new q(P.comparator)).toArray()}}class dt{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new dt(0)}static vn(){return new dt(-1)}}class Ad{constructor(){this.changes=new Et(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ee.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?m.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Dd{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class kd{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Rt(r.mutation,s,ge.empty(),j.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,N()).next(()=>r))}getLocalViewOfDocuments(e,n,r=N()){const s=He();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ct();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=He();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,N()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=De();const o=Ot(),a=Ot();return n.forEach((c,l)=>{const u=r.get(l.key);s.has(l.key)&&(u===void 0||u.mutation instanceof Ye)?i=i.insert(l.key,l):u!==void 0&&(o.set(l.key,u.mutation.getFieldMask()),Rt(u.mutation,l,u.mutation.getFieldMask(),j.now()))}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var d;return a.set(l,new Dd(u,(d=o.get(l))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Ot();let s=new H((o,a)=>o-a),i=N();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=r.get(c)||ge.empty();u=a.applyToLocalView(l,u),r.set(c,u);const d=(s.get(a.batchId)||N()).add(c);s=s.insert(a.batchId,d)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,d=xc();u.forEach(h=>{if(!i.has(h)){const f=Ic(n.get(h),r.get(h));f!==null&&d.set(h,f),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return m.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return T.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Uf(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):m.resolve(He());let a=-1,c=i;return o.next(l=>m.forEach(l,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(u)?m.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{c=c.insert(u,h)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,N())).next(u=>({batchId:a,changes:Nc(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new T(n)).next(r=>{let s=Ct();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=Ct();return this.indexManager.getCollectionParents(e,s).next(o=>m.forEach(o,a=>{const c=function(l,u){return new fr(u,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(l=>{l.forEach((u,d)=>{i=i.insert(u,d)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.remoteDocumentCache.getAllFromCollection(e,n.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId))).next(i=>{i.forEach((a,c)=>{const l=c.getKey();s.get(l)===null&&(s=s.insert(l,ee.newInvalidDocument(l)))});let o=Ct();return s.forEach((a,c)=>{const l=i.get(a);l!==void 0&&Rt(l.mutation,c,ge.empty(),j.now()),Ks(n,c)&&(o=o.insert(a,c))}),o})}}class Nd{constructor(e){this.yt=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,n){return m.resolve(this.Zn.get(n))}saveBundleMetadata(e,n){var r;return this.Zn.set(n.id,{id:(r=n).id,version:r.version,createTime:ye(r.createTime)}),m.resolve()}getNamedQuery(e,n){return m.resolve(this.ts.get(n))}saveNamedQuery(e,n){return this.ts.set(n.name,function(r){return{name:r.name,query:Sd(r.bundledQuery),readTime:ye(r.readTime)}}(n)),m.resolve()}}class xd{constructor(){this.overlays=new H(T.comparator),this.es=new Map}getOverlay(e,n){return m.resolve(this.overlays.get(n))}getOverlays(e,n){const r=He();return m.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.oe(e,n,i)}),m.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.es.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(r)),m.resolve()}getOverlaysForCollection(e,n,r){const s=He(),i=n.length+1,o=new T(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return m.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new H((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=i.get(l.largestBatchId);u===null&&(u=He(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=He(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=s)););return m.resolve(a)}oe(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.es.get(s.largestBatchId).delete(r.key);this.es.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new bd(n,r));let i=this.es.get(n);i===void 0&&(i=N(),this.es.set(n,i)),this.es.set(n,i.add(r.key))}}class Ws{constructor(){this.ns=new q(K.ss),this.rs=new q(K.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,n){const r=new K(e,n);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.cs(new K(e,n))}hs(e,n){e.forEach(r=>this.removeReference(r,n))}ls(e){const n=new T(new P([])),r=new K(n,e),s=new K(n,e+1),i=[];return this.rs.forEachInRange([r,s],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const n=new T(new P([])),r=new K(n,e),s=new K(n,e+1);let i=N();return this.rs.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new K(e,0),r=this.ns.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class K{constructor(e,n){this.key=e,this._s=n}static ss(e,n){return T.comparator(e.key,n.key)||O(e._s,n._s)}static os(e,n){return O(e._s,n._s)||T.comparator(e.key,n.key)}}class Rd{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.ws=1,this.gs=new q(K.ss)}checkEmpty(e){return m.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ed(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.gs=this.gs.add(new K(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return m.resolve(o)}lookupMutationBatch(e,n){return m.resolve(this.ys(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ps(r),i=s<0?0:s;return m.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return m.resolve(this.mutationQueue.length===0?-1:this.ws-1)}getAllMutationBatches(e){return m.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new K(n,0),s=new K(n,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([r,s],o=>{const a=this.ys(o._s);i.push(a)}),m.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new q(O);return n.forEach(s=>{const i=new K(s,0),o=new K(s,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],a=>{r=r.add(a._s)})}),m.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;T.isDocumentKey(i)||(i=i.child(""));const o=new K(new T(i),0);let a=new q(O);return this.gs.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===s&&(a=a.add(c._s)),!0)},o),m.resolve(this.Is(a))}Is(e){const n=[];return e.forEach(r=>{const s=this.ys(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){L(this.Ts(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.gs;return m.forEach(n.mutations,s=>{const i=new K(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.gs=r})}An(e){}containsKey(e,n){const r=new K(n,0),s=this.gs.firstAfterOrEqual(r);return m.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,m.resolve()}Ts(e,n){return this.ps(e)}ps(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ys(e){const n=this.ps(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class Od{constructor(e){this.Es=e,this.docs=new H(T.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Es(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return m.resolve(r?r.document.mutableCopy():ee.newInvalidDocument(n))}getEntries(e,n){let r=De();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():ee.newInvalidDocument(s))}),m.resolve(r)}getAllFromCollection(e,n,r){let s=De();const i=new T(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:c}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||_f(vf(c),r)<=0||(s=s.insert(c.key,c.mutableCopy()))}return m.resolve(s)}getAllFromCollectionGroup(e,n,r,s){C()}As(e,n){return m.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Ld(this)}getSize(e){return m.resolve(this.size)}}class Ld extends Ad{constructor(e){super(),this.Yn=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Yn.addEntry(e,s)):this.Yn.removeEntry(r)}),m.waitFor(n)}getFromCache(e,n){return this.Yn.getEntry(e,n)}getAllFromCache(e,n){return this.Yn.getEntries(e,n)}}class Md{constructor(e){this.persistence=e,this.Rs=new Et(n=>js(n),qs),this.lastRemoteSnapshotVersion=A.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Ws,this.targetCount=0,this.vs=dt.Pn()}forEachTarget(e,n){return this.Rs.forEach((r,s)=>n(s)),m.resolve()}getLastRemoteSnapshotVersion(e){return m.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return m.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),m.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.bs&&(this.bs=n),m.resolve()}Dn(e){this.Rs.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.vs=new dt(n),this.highestTargetId=n),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,n){return this.Dn(n),this.targetCount+=1,m.resolve()}updateTargetData(e,n){return this.Dn(n),m.resolve()}removeTargetData(e,n){return this.Rs.delete(n.target),this.Ps.ls(n.targetId),this.targetCount-=1,m.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Rs.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),m.waitFor(i).next(()=>s)}getTargetCount(e){return m.resolve(this.targetCount)}getTargetData(e,n){const r=this.Rs.get(n)||null;return m.resolve(r)}addMatchingKeys(e,n,r){return this.Ps.us(n,r),m.resolve()}removeMatchingKeys(e,n,r){this.Ps.hs(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),m.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Ps.ls(n),m.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Ps.ds(n);return m.resolve(r)}containsKey(e,n){return m.resolve(this.Ps.containsKey(n))}}class Pd{constructor(e,n){this.Vs={},this.overlays={},this.Ss=new Us(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new Md(this),this.indexManager=new Id,this.remoteDocumentCache=function(r){return new Od(r)}(r=>this.referenceDelegate.xs(r)),this.yt=new Td(n),this.Ns=new Nd(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new xd,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Vs[e.toKey()];return r||(r=new Rd(n,this.referenceDelegate),this.Vs[e.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,n,r){b("MemoryPersistence","Starting transaction:",e);const s=new Fd(this.Ss.next());return this.referenceDelegate.ks(),r(s).next(i=>this.referenceDelegate.Os(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ms(e,n){return m.or(Object.values(this.Vs).map(r=>()=>r.containsKey(e,n)))}}class Fd extends Ef{constructor(e){super(),this.currentSequenceNumber=e}}class Qs{constructor(e){this.persistence=e,this.Fs=new Ws,this.$s=null}static Bs(e){return new Qs(e)}get Ls(){if(this.$s)return this.$s;throw C()}addReference(e,n,r){return this.Fs.addReference(r,n),this.Ls.delete(r.toString()),m.resolve()}removeReference(e,n,r){return this.Fs.removeReference(r,n),this.Ls.add(r.toString()),m.resolve()}markPotentiallyOrphaned(e,n){return this.Ls.add(n.toString()),m.resolve()}removeTarget(e,n){this.Fs.ls(n.targetId).forEach(s=>this.Ls.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Ls.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}ks(){this.$s=new Set}Os(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return m.forEach(this.Ls,r=>{const s=T.fromPath(r);return this.qs(e,s).next(i=>{i||n.removeEntry(s,A.min())})}).next(()=>(this.$s=null,n.apply(e)))}updateLimboDocument(e,n){return this.qs(e,n).next(r=>{r?this.Ls.delete(n.toString()):this.Ls.add(n.toString())})}xs(e){return 0}qs(e,n){return m.or([()=>m.resolve(this.Fs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ms(e,n)])}}class Xs{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Si=r,this.Di=s}static Ci(e,n){let r=N(),s=N();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Xs(e,n.fromCache,r,s)}}class Vd{constructor(){this.xi=!1}initialize(e,n){this.Ni=e,this.indexManager=n,this.xi=!0}getDocumentsMatchingQuery(e,n,r,s){return this.ki(e,n).next(i=>i||this.Oi(e,n,s,r)).next(i=>i||this.Mi(e,n))}ki(e,n){if(Xi(n))return m.resolve(null);let r=Ae(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=as(n,null,"F"),r=Ae(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=N(...i);return this.Ni.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const l=this.Fi(n,a);return this.$i(n,l,o,c.readTime)?this.ki(e,as(n,null,"F")):this.Bi(e,l,n,c)}))})))}Oi(e,n,r,s){return Xi(n)||s.isEqual(A.min())?this.Mi(e,n):this.Ni.getDocuments(e,r).next(i=>{const o=this.Fi(n,i);return this.$i(n,o,r,s)?this.Mi(e,n):(Bi()<=R.DEBUG&&b("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),cs(n)),this.Bi(e,o,n,yf(s,-1)))})}Fi(e,n){let r=new q(vc(e));return n.forEach((s,i)=>{Ks(e,i)&&(r=r.add(i))}),r}$i(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(e,n){return Bi()<=R.DEBUG&&b("QueryEngine","Using full collection scan to execute query:",cs(n)),this.Ni.getDocumentsMatchingQuery(e,n,Pe.min())}Bi(e,n,r,s){return this.Ni.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}class $d{constructor(e,n,r,s){this.persistence=e,this.Li=n,this.yt=s,this.qi=new H(O),this.Ui=new Et(i=>js(i),qs),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(r)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new kd(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.qi))}}function Ud(t,e,n,r){return new $d(t,e,n,r)}async function Bc(t,e){const n=D(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Qi(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=N();for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({ji:l,removedBatchIds:o,addedBatchIds:a}))})})}function Bd(t,e){const n=D(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const u=c.batch,d=u.keys();let h=m.resolve();return d.forEach(f=>{h=h.next(()=>l.getEntry(a,f)).next(p=>{const v=c.docVersions.get(f);L(v!==null),p.version.compareTo(v)<0&&(u.applyToRemoteDocument(p,c),p.isValidDocument()&&(p.setReadTime(c.commitVersion),l.addEntry(p)))})}),h.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=N();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function jc(t){const e=D(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Cs.getLastRemoteSnapshotVersion(n))}function jd(t,e){const n=D(t),r=e.snapshotVersion;let s=n.qi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Gi.newChangeBuffer({trackRemovals:!0});s=n.qi;const a=[];e.targetChanges.forEach((u,d)=>{const h=s.get(d);if(!h)return;a.push(n.Cs.removeMatchingKeys(i,u.removedDocuments,d).next(()=>n.Cs.addMatchingKeys(i,u.addedDocuments,d)));let f=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(d)?f=f.withResumeToken(se.EMPTY_BYTE_STRING,A.min()).withLastLimboFreeSnapshotVersion(A.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),s=s.insert(d,f),function(p,v,_){return p.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(h,f,u)&&a.push(n.Cs.updateTargetData(i,f))});let c=De(),l=N();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(qd(i,o,e.documentUpdates).next(u=>{c=u.Wi,l=u.zi})),!r.isEqual(A.min())){const u=n.Cs.getLastRemoteSnapshotVersion(i).next(d=>n.Cs.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return m.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(n.qi=s,i))}function qd(t,e,n){let r=N(),s=N();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=De();return n.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(A.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):b("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Wi:o,zi:s}})}function Hd(t,e){const n=D(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Kd(t,e){const n=D(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Cs.getTargetData(r,e).next(i=>i?(s=i,m.resolve(s)):n.Cs.allocateTargetId(r).next(o=>(s=new ze(e,o,0,r.currentSequenceNumber),n.Cs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.qi.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.qi=n.qi.insert(r.targetId,r),n.Ui.set(e,r.targetId)),r})}async function fs(t,e,n){const r=D(t),s=r.qi.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!an(o))throw o;b("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.qi=r.qi.remove(e),r.Ui.delete(s.target)}function io(t,e,n){const r=D(t);let s=A.min(),i=N();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const u=D(a),d=u.Ui.get(l);return d!==void 0?m.resolve(u.qi.get(d)):u.Cs.getTargetData(c,l)}(r,o,Ae(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Li.getDocumentsMatchingQuery(o,e,n?s:A.min(),n?i:N())).next(a=>(zd(r,Bf(e),a),{documents:a,Hi:i})))}function zd(t,e,n){let r=t.Ki.get(e)||A.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ki.set(e,r)}class oo{constructor(){this.activeTargetIds=Rc()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gd{constructor(){this.Lr=new oo,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Lr.er(e),this.qr[e]||"not-current"}updateQueryState(e,n,r){this.qr[e]=n}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.qr[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new oo,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Wd{Ur(e){}shutdown(){}}class ao{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){b("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){b("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}const Qd={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Xd{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class Yd extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.oo=n+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,n,r,s,i){const o=this.ho(e,n);b("RestConnection","Sending: ",o,r);const a={};return this.lo(a,s,i),this.fo(e,o,a,r).then(c=>(b("RestConnection","Received: ",c),c),c=>{throw rs("RestConnection",`${e} failed with error: `,c,"url: ",o,"request:",r),c})}_o(e,n,r,s,i,o){return this.ao(e,n,r,s,i)}lo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+_t,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}ho(e,n){const r=Qd[e];return`${this.oo}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,n,r,s){return new Promise((i,o)=>{const a=new af;a.setWithCredentials(!0),a.listenOnce(rf.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Or.NO_ERROR:const l=a.getResponseJson();b("Connection","XHR received:",JSON.stringify(l)),i(l);break;case Or.TIMEOUT:b("Connection",'RPC "'+e+'" timed out'),o(new S(g.DEADLINE_EXCEEDED,"Request time out"));break;case Or.HTTP_ERROR:const u=a.getStatus();if(b("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){let d=a.getResponseJson();Array.isArray(d)&&(d=d[0]);const h=d==null?void 0:d.error;if(h&&h.status&&h.message){const f=function(p){const v=p.toLowerCase().replace(/_/g,"-");return Object.values(g).indexOf(v)>=0?v:g.UNKNOWN}(h.status);o(new S(f,h.message))}else o(new S(g.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new S(g.UNAVAILABLE,"Connection failed."));break;default:C()}}finally{b("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(s);a.send(n,"POST",c,r,15)})}wo(e,n,r){const s=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=tf(),o=nf(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new of({})),this.lo(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const c=s.join("");b("Connection","Creating WebChannel: "+c,a);const l=i.createWebChannel(c,a);let u=!1,d=!1;const h=new Xd({Hr:p=>{d?b("Connection","Not sending because WebChannel is closed:",p):(u||(b("Connection","Opening WebChannel transport."),l.open(),u=!0),b("Connection","WebChannel sending:",p),l.send(p))},Jr:()=>l.close()}),f=(p,v,_)=>{p.listen(v,E=>{try{_(E)}catch(k){setTimeout(()=>{throw k},0)}})};return f(l,mn.EventType.OPEN,()=>{d||b("Connection","WebChannel transport opened.")}),f(l,mn.EventType.CLOSE,()=>{d||(d=!0,b("Connection","WebChannel transport closed"),h.io())}),f(l,mn.EventType.ERROR,p=>{d||(d=!0,rs("Connection","WebChannel transport errored:",p),h.io(new S(g.UNAVAILABLE,"The operation could not be completed")))}),f(l,mn.EventType.MESSAGE,p=>{var v;if(!d){const _=p.data[0];L(!!_);const E=_,k=E.error||((v=E[0])===null||v===void 0?void 0:v.error);if(k){b("Connection","WebChannel received error:",k);const J=k.status;let W=function(ke){const pe=V[ke];if(pe!==void 0)return Dc(pe)}(J),fe=k.message;W===void 0&&(W=g.INTERNAL,fe="Unknown error status: "+J+" with message "+k.message),d=!0,h.io(new S(W,fe)),l.close()}else b("Connection","WebChannel received:",_),h.ro(_)}}),f(o,sf.STAT_EVENT,p=>{p.stat===$i.PROXY?b("Connection","Detected buffering proxy"):p.stat===$i.NOPROXY&&b("Connection","Detected no buffering proxy")}),setTimeout(()=>{h.so()},0),h}}function Mr(){return typeof document<"u"?document:null}function yr(t){return new ad(t,!0)}class qc{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Hs=e,this.timerId=n,this.mo=r,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const n=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),s=Math.max(0,n-r);s>0&&b("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){this.To!==null&&(this.To.skipDelay(),this.To=null)}cancel(){this.To!==null&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class Hc{constructor(e,n,r,s,i,o,a,c){this.Hs=e,this.vo=r,this.Vo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new qc(e,n)}No(){return this.state===1||this.state===5||this.ko()}ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Oo()}async stop(){this.No()&&await this.close(0)}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&this.Do===null&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(e,n){this.Lo(),this.qo(),this.xo.cancel(),this.So++,e!==4?this.xo.reset():n&&n.code===g.RESOURCE_EXHAUSTED?(Ce(n.toString()),Ce("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):n&&n.code===g.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Uo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zr(n)}Uo(){}auth(){this.state=1;const e=this.Ko(this.So),n=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.So===n&&this.Go(r,s)},r=>{e(()=>{const s=new S(g.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(s)})})}Go(e,n){const r=this.Ko(this.So);this.stream=this.jo(e,n),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(s=>{r(()=>this.Qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Oo(){this.state=5,this.xo.Ro(async()=>{this.state=0,this.start()})}Qo(e){return b("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return n=>{this.Hs.enqueueAndForget(()=>this.So===e?n():(b("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Jd extends Hc{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.yt=i}jo(e,n){return this.connection.wo("Listen",e,n)}onMessage(e){this.xo.reset();const n=ld(this.yt,e),r=function(s){if(!("targetChange"in s))return A.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?A.min():i.readTime?ye(i.readTime):A.min()}(e);return this.listener.Wo(n,r)}zo(e){const n={};n.database=hs(this.yt),n.addTarget=function(s,i){let o;const a=i.target;return o=os(a)?{documents:dd(s,a)}:{query:pd(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=Mc(s,i.resumeToken):i.snapshotVersion.compareTo(A.min())>0&&(o.readTime=Kn(s,i.snapshotVersion.toTimestamp())),o}(this.yt,e);const r=gd(this.yt,e);r&&(n.labels=r),this.Bo(n)}Ho(e){const n={};n.database=hs(this.yt),n.removeTarget=e,this.Bo(n)}}class Zd extends Hc{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.yt=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(e,n){return this.connection.wo("Write",e,n)}onMessage(e){if(L(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const n=fd(e.writeResults,e.commitTime),r=ye(e.commitTime);return this.listener.Zo(r,n)}return L(!e.writeResults||e.writeResults.length===0),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=hs(this.yt),this.Bo(e)}Xo(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>hd(this.yt,r))};this.Bo(n)}}class ep extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.yt=s,this.nu=!1}su(){if(this.nu)throw new S(g.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,n,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.ao(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===g.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new S(g.UNKNOWN,s.toString())})}_o(e,n,r,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection._o(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===g.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new S(g.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class tp{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){this.iu===0&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){this.state==="Online"?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,e==="Online"&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Ce(n),this.ou=!1):b("OnlineStateTracker",n)}lu(){this.ru!==null&&(this.ru.cancel(),this.ru=null)}}class np{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.Ur(o=>{r.enqueueAndForget(async()=>{Je(this)&&(b("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=D(a);c._u.add(4),await ln(c),c.gu.set("Unknown"),c._u.delete(4),await vr(c)}(this))})}),this.gu=new tp(r,s)}}async function vr(t){if(Je(t))for(const e of t.wu)await e(!0)}async function ln(t){for(const e of t.wu)await e(!1)}function Kc(t,e){const n=D(t);n.du.has(e.targetId)||(n.du.set(e.targetId,e),Zs(n)?Js(n):bt(n).ko()&&Ys(n,e))}function zc(t,e){const n=D(t),r=bt(n);n.du.delete(e),r.ko()&&Gc(n,e),n.du.size===0&&(r.ko()?r.Fo():Je(n)&&n.gu.set("Unknown"))}function Ys(t,e){t.yu.Ot(e.targetId),bt(t).zo(e)}function Gc(t,e){t.yu.Ot(e),bt(t).Ho(e)}function Js(t){t.yu=new rd({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>t.du.get(e)||null}),bt(t).start(),t.gu.uu()}function Zs(t){return Je(t)&&!bt(t).No()&&t.du.size>0}function Je(t){return D(t)._u.size===0}function Wc(t){t.yu=void 0}async function rp(t){t.du.forEach((e,n)=>{Ys(t,e)})}async function sp(t,e){Wc(t),Zs(t)?(t.gu.hu(e),Js(t)):t.gu.set("Unknown")}async function ip(t,e,n){if(t.gu.set("Online"),e instanceof Lc&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.du.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.du.delete(o),r.yu.removeTarget(o))}(t,e)}catch(r){b("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zn(t,r)}else if(e instanceof bn?t.yu.Kt(e):e instanceof Oc?t.yu.Jt(e):t.yu.jt(e),!n.isEqual(A.min()))try{const r=await jc(t.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.yu.Zt(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=s.du.get(c);l&&s.du.set(c,l.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const c=s.du.get(a);if(!c)return;s.du.set(a,c.withResumeToken(se.EMPTY_BYTE_STRING,c.snapshotVersion)),Gc(s,a);const l=new ze(c.target,a,1,c.sequenceNumber);Ys(s,l)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){b("RemoteStore","Failed to raise snapshot:",r),await zn(t,r)}}async function zn(t,e,n){if(!an(e))throw e;t._u.add(1),await ln(t),t.gu.set("Offline"),n||(n=()=>jc(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{b("RemoteStore","Retrying IndexedDB access"),await n(),t._u.delete(1),await vr(t)})}function Qc(t,e){return e().catch(n=>zn(t,n,e))}async function _r(t){const e=D(t),n=Ve(e);let r=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;op(e);)try{const s=await Hd(e.localStore,r);if(s===null){e.fu.length===0&&n.Fo();break}r=s.batchId,ap(e,s)}catch(s){await zn(e,s)}Xc(e)&&Yc(e)}function op(t){return Je(t)&&t.fu.length<10}function ap(t,e){t.fu.push(e);const n=Ve(t);n.ko()&&n.Yo&&n.Xo(e.mutations)}function Xc(t){return Je(t)&&!Ve(t).No()&&t.fu.length>0}function Yc(t){Ve(t).start()}async function cp(t){Ve(t).eu()}async function up(t){const e=Ve(t);for(const n of t.fu)e.Xo(n.mutations)}async function lp(t,e,n){const r=t.fu.shift(),s=Gs.from(r,e,n);await Qc(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await _r(t)}async function hp(t,e){e&&Ve(t).Yo&&await async function(n,r){if(s=r.code,Jf(s)&&s!==g.ABORTED){const i=n.fu.shift();Ve(n).Mo(),await Qc(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await _r(n)}var s}(t,e),Xc(t)&&Yc(t)}async function co(t,e){const n=D(t);n.asyncQueue.verifyOperationInProgress(),b("RemoteStore","RemoteStore received new credentials");const r=Je(n);n._u.add(3),await ln(n),r&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n._u.delete(3),await vr(n)}async function fp(t,e){const n=D(t);e?(n._u.delete(2),await vr(n)):e||(n._u.add(2),await ln(n),n.gu.set("Unknown"))}function bt(t){return t.pu||(t.pu=function(e,n,r){const s=D(e);return s.su(),new Jd(n,s.connection,s.authCredentials,s.appCheckCredentials,s.yt,r)}(t.datastore,t.asyncQueue,{Yr:rp.bind(null,t),Zr:sp.bind(null,t),Wo:ip.bind(null,t)}),t.wu.push(async e=>{e?(t.pu.Mo(),Zs(t)?Js(t):t.gu.set("Unknown")):(await t.pu.stop(),Wc(t))})),t.pu}function Ve(t){return t.Iu||(t.Iu=function(e,n,r){const s=D(e);return s.su(),new Zd(n,s.connection,s.authCredentials,s.appCheckCredentials,s.yt,r)}(t.datastore,t.asyncQueue,{Yr:cp.bind(null,t),Zr:hp.bind(null,t),tu:up.bind(null,t),Zo:lp.bind(null,t)}),t.wu.push(async e=>{e?(t.Iu.Mo(),await _r(t)):(await t.Iu.stop(),t.fu.length>0&&(b("RemoteStore",`Stopping write stream with ${t.fu.length} pending writes`),t.fu=[]))})),t.Iu}class ei{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Me,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new ei(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new S(g.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ti(t,e){if(Ce("AsyncQueue",`${e}: ${t}`),an(t))return new S(g.UNAVAILABLE,`${e}: ${t}`);throw t}class at{constructor(e){this.comparator=e?(n,r)=>e(n,r)||T.comparator(n.key,r.key):(n,r)=>T.comparator(n.key,r.key),this.keyedMap=Ct(),this.sortedSet=new H(this.comparator)}static emptySet(e){return new at(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof at)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new at;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class uo{constructor(){this.Tu=new H(T.comparator)}track(e){const n=e.doc.key,r=this.Tu.get(n);r?e.type!==0&&r.type===3?this.Tu=this.Tu.insert(n,e):e.type===3&&r.type!==1?this.Tu=this.Tu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Tu=this.Tu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Tu=this.Tu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Tu=this.Tu.remove(n):e.type===1&&r.type===2?this.Tu=this.Tu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Tu=this.Tu.insert(n,{type:2,doc:e.doc}):C():this.Tu=this.Tu.insert(n,e)}Eu(){const e=[];return this.Tu.inorderTraversal((n,r)=>{e.push(r)}),e}}class pt{constructor(e,n,r,s,i,o,a,c,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new pt(e,n,at.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&dr(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}class dp{constructor(){this.Au=void 0,this.listeners=[]}}class pp{constructor(){this.queries=new Et(e=>yc(e),dr),this.onlineState="Unknown",this.Ru=new Set}}async function mp(t,e){const n=D(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new dp),s)try{i.Au=await n.onListen(r)}catch(o){const a=ti(o,`Initialization of query '${cs(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.bu(n.onlineState),i.Au&&e.Pu(i.Au)&&ni(n)}async function gp(t,e){const n=D(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function yp(t,e){const n=D(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Pu(s)&&(r=!0);o.Au=s}}r&&ni(n)}function vp(t,e,n){const r=D(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function ni(t){t.Ru.forEach(e=>{e.next()})}class _p{constructor(e,n,r){this.query=e,this.vu=n,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new pt(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),n=!0):this.Cu(e,this.onlineState)&&(this.xu(e),n=!0),this.Su=e,n}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let n=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),n=!0),n}Cu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Nu||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Du(e){if(e.docChanges.length>0)return!0;const n=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}xu(e){e=pt.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}class Jc{constructor(e){this.key=e}}class Zc{constructor(e){this.key=e}}class wp{constructor(e,n){this.query=e,this.qu=n,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=N(),this.mutatedKeys=N(),this.Gu=vc(e),this.Qu=new at(this.Gu)}get ju(){return this.qu}Wu(e,n){const r=n?n.zu:new uo,s=n?n.Qu:this.Qu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,d)=>{const h=s.get(u),f=Ks(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),v=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let _=!1;h&&f?h.data.isEqual(f.data)?p!==v&&(r.track({type:3,doc:f}),_=!0):this.Hu(h,f)||(r.track({type:2,doc:f}),_=!0,(c&&this.Gu(f,c)>0||l&&this.Gu(f,l)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),_=!0):h&&!f&&(r.track({type:1,doc:h}),_=!0,(c||l)&&(a=!0)),_&&(f?(o=o.add(f),i=v?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Qu:o,zu:r,$i:a,mutatedKeys:i}}Hu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const i=e.zu.Eu();i.sort((l,u)=>function(d,h){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return C()}};return f(d)-f(h)}(l.type,u.type)||this.Gu(l.doc,u.doc)),this.Ju(r);const o=n?this.Yu():[],a=this.Ku.size===0&&this.current?1:0,c=a!==this.Uu;return this.Uu=a,i.length!==0||c?{snapshot:new pt(this.query,e.Qu,s,i,e.mutatedKeys,a===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new uo,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(n=>this.qu=this.qu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.qu=this.qu.delete(n)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=N(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const n=[];return e.forEach(r=>{this.Ku.has(r)||n.push(new Zc(r))}),this.Ku.forEach(r=>{e.has(r)||n.push(new Jc(r))}),n}tc(e){this.qu=e.Hi,this.Ku=N();const n=this.Wu(e.documents);return this.applyChanges(n,!0)}ec(){return pt.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,this.Uu===0,this.hasCachedResults)}}class Ep{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class bp{constructor(e){this.key=e,this.nc=!1}}class Tp{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new Et(a=>yc(a),dr),this.rc=new Map,this.oc=new Set,this.uc=new H(T.comparator),this.cc=new Map,this.ac=new Ws,this.hc={},this.lc=new Map,this.fc=dt.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return this.dc===!0}}async function Sp(t,e){const n=Lp(t);let r,s;const i=n.ic.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.ec();else{const o=await Kd(n.localStore,Ae(e));n.isPrimaryClient&&Kc(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await Ip(n,e,r,a==="current",o.resumeToken)}return s}async function Ip(t,e,n,r,s){t._c=(d,h,f)=>async function(p,v,_,E){let k=v.view.Wu(_);k.$i&&(k=await io(p.localStore,v.query,!1).then(({documents:fe})=>v.view.Wu(fe,k)));const J=E&&E.targetChanges.get(v.targetId),W=v.view.applyChanges(k,p.isPrimaryClient,J);return ho(p,v.targetId,W.Xu),W.snapshot}(t,d,h,f);const i=await io(t.localStore,e,!0),o=new wp(e,i.Hi),a=o.Wu(i.documents),c=un.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),l=o.applyChanges(a,t.isPrimaryClient,c);ho(t,n,l.Xu);const u=new Ep(e,n,o);return t.ic.set(e,u),t.rc.has(n)?t.rc.get(n).push(e):t.rc.set(n,[e]),l.snapshot}async function Cp(t,e){const n=D(t),r=n.ic.get(e),s=n.rc.get(r.targetId);if(s.length>1)return n.rc.set(r.targetId,s.filter(i=>!dr(i,e))),void n.ic.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await fs(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),zc(n.remoteStore,r.targetId),ds(n,r.targetId)}).catch(on)):(ds(n,r.targetId),await fs(n.localStore,r.targetId,!0))}async function Ap(t,e,n){const r=Mp(t);try{const s=await function(i,o){const a=D(i),c=j.now(),l=o.reduce((h,f)=>h.add(f.key),N());let u,d;return a.persistence.runTransaction("Locally write mutations","readwrite",h=>{let f=De(),p=N();return a.Gi.getEntries(h,l).next(v=>{f=v,f.forEach((_,E)=>{E.isValidDocument()||(p=p.add(_))})}).next(()=>a.localDocuments.getOverlayedDocuments(h,f)).next(v=>{u=v;const _=[];for(const E of o){const k=Qf(E,u.get(E.key).overlayedDocument);k!=null&&_.push(new Ye(E.key,k,gc(k.value.mapValue),Se.exists(!0)))}return a.mutationQueue.addMutationBatch(h,c,_,o)}).next(v=>{d=v;const _=v.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(h,v.batchId,_)})}).then(()=>({batchId:d.batchId,changes:Nc(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let c=i.hc[i.currentUser.toKey()];c||(c=new H(O)),c=c.insert(o,a),i.hc[i.currentUser.toKey()]=c}(r,s.batchId,n),await hn(r,s.changes),await _r(r.remoteStore)}catch(s){const i=ti(s,"Failed to persist write");n.reject(i)}}async function eu(t,e){const n=D(t);try{const r=await jd(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.cc.get(i);o&&(L(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.nc=!0:s.modifiedDocuments.size>0?L(o.nc):s.removedDocuments.size>0&&(L(o.nc),o.nc=!1))}),await hn(n,r,e)}catch(r){await on(r)}}function lo(t,e,n){const r=D(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.ic.forEach((i,o)=>{const a=o.view.bu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=D(i);a.onlineState=o;let c=!1;a.queries.forEach((l,u)=>{for(const d of u.listeners)d.bu(o)&&(c=!0)}),c&&ni(a)}(r.eventManager,e),s.length&&r.sc.Wo(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Dp(t,e,n){const r=D(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.cc.get(e),i=s&&s.key;if(i){let o=new H(T.comparator);o=o.insert(i,ee.newNoDocument(i,A.min()));const a=N().add(i),c=new gr(A.min(),new Map,new q(O),o,a);await eu(r,c),r.uc=r.uc.remove(i),r.cc.delete(e),ri(r)}else await fs(r.localStore,e,!1).then(()=>ds(r,e,n)).catch(on)}async function kp(t,e){const n=D(t),r=e.batch.batchId;try{const s=await Bd(n.localStore,e);nu(n,r,null),tu(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await hn(n,s)}catch(s){await on(s)}}async function Np(t,e,n){const r=D(t);try{const s=await function(i,o){const a=D(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(u=>(L(u!==null),l=u.keys(),a.mutationQueue.removeMutationBatch(c,u))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(r.localStore,e);nu(r,e,n),tu(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await hn(r,s)}catch(s){await on(s)}}function tu(t,e){(t.lc.get(e)||[]).forEach(n=>{n.resolve()}),t.lc.delete(e)}function nu(t,e,n){const r=D(t);let s=r.hc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.hc[r.currentUser.toKey()]=s}}function ds(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.rc.get(e))t.ic.delete(r),n&&t.sc.wc(r,n);t.rc.delete(e),t.isPrimaryClient&&t.ac.ls(e).forEach(r=>{t.ac.containsKey(r)||ru(t,r)})}function ru(t,e){t.oc.delete(e.path.canonicalString());const n=t.uc.get(e);n!==null&&(zc(t.remoteStore,n),t.uc=t.uc.remove(e),t.cc.delete(n),ri(t))}function ho(t,e,n){for(const r of n)r instanceof Jc?(t.ac.addReference(r.key,e),xp(t,r)):r instanceof Zc?(b("SyncEngine","Document no longer in limbo: "+r.key),t.ac.removeReference(r.key,e),t.ac.containsKey(r.key)||ru(t,r.key)):C()}function xp(t,e){const n=e.key,r=n.path.canonicalString();t.uc.get(n)||t.oc.has(r)||(b("SyncEngine","New document in limbo: "+n),t.oc.add(r),ri(t))}function ri(t){for(;t.oc.size>0&&t.uc.size<t.maxConcurrentLimboResolutions;){const e=t.oc.values().next().value;t.oc.delete(e);const n=new T(P.fromString(e)),r=t.fc.next();t.cc.set(r,new bp(n)),t.uc=t.uc.insert(n,r),Kc(t.remoteStore,new ze(Ae(Hs(n.path)),r,2,Us.at))}}async function hn(t,e,n){const r=D(t),s=[],i=[],o=[];r.ic.isEmpty()||(r.ic.forEach((a,c)=>{o.push(r._c(c,e,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l!=null&&l.fromCache?"not-current":"current"),l){s.push(l);const u=Xs.Ci(c.targetId,l);i.push(u)}}))}),await Promise.all(o),r.sc.Wo(s),await async function(a,c){const l=D(a);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>m.forEach(c,d=>m.forEach(d.Si,h=>l.persistence.referenceDelegate.addReference(u,d.targetId,h)).next(()=>m.forEach(d.Di,h=>l.persistence.referenceDelegate.removeReference(u,d.targetId,h)))))}catch(u){if(!an(u))throw u;b("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const d=u.targetId;if(!u.fromCache){const h=l.qi.get(d),f=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(f);l.qi=l.qi.insert(d,p)}}}(r.localStore,i))}async function Rp(t,e){const n=D(t);if(!n.currentUser.isEqual(e)){b("SyncEngine","User change. New user:",e.toKey());const r=await Bc(n.localStore,e);n.currentUser=e,function(s,i){s.lc.forEach(o=>{o.forEach(a=>{a.reject(new S(g.CANCELLED,i))})}),s.lc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await hn(n,r.ji)}}function Op(t,e){const n=D(t),r=n.cc.get(e);if(r&&r.nc)return N().add(r.key);{let s=N();const i=n.rc.get(e);if(!i)return s;for(const o of i){const a=n.ic.get(o);s=s.unionWith(a.view.ju)}return s}}function Lp(t){const e=D(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=eu.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Op.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Dp.bind(null,e),e.sc.Wo=yp.bind(null,e.eventManager),e.sc.wc=vp.bind(null,e.eventManager),e}function Mp(t){const e=D(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kp.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Np.bind(null,e),e}class Pp{constructor(){this.synchronizeTabs=!1}async initialize(e){this.yt=yr(e.databaseInfo.databaseId),this.sharedClientState=this.gc(e),this.persistence=this.yc(e),await this.persistence.start(),this.localStore=this.Ic(e),this.gcScheduler=this.Tc(e,this.localStore),this.indexBackfillerScheduler=this.Ec(e,this.localStore)}Tc(e,n){return null}Ec(e,n){return null}Ic(e){return Ud(this.persistence,new Vd,e.initialUser,this.yt)}yc(e){return new Pd(Qs.Bs,this.yt)}gc(e){return new Gd}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Fp{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>lo(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Rp.bind(null,this.syncEngine),await fp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new pp}createDatastore(e){const n=yr(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new Yd(s));var s;return function(i,o,a,c){return new ep(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>lo(this.syncEngine,a,0),o=ao.C()?new ao:new Wd,new np(n,r,s,i,o);var n,r,s,i,o}createSyncEngine(e,n){return function(r,s,i,o,a,c,l){const u=new Tp(r,s,i,o,a,c);return l&&(u.dc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=D(e);b("RemoteStore","RemoteStore shutting down."),n._u.add(5),await ln(n),n.mu.shutdown(),n.gu.set("Unknown")}(this.remoteStore)}}function Vp(t,e,n){if(!n)throw new S(g.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $p(t,e,n,r){if(e===!0&&r===!0)throw new S(g.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function fo(t){if(!T.isDocumentKey(t))throw new S(g.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function si(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":C()}function Wt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new S(g.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=si(t);throw new S(g.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}const po=new Map;class mo{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new S(g.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new S(g.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,$p("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ii{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mo({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new S(g.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new S(g.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mo(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new cf;switch(n.type){case"gapi":const r=n.client;return new ff(r,n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new S(g.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=po.get(e);n&&(b("ComponentProvider","Removing Datastore"),po.delete(e),n.terminate())}(this),Promise.resolve()}}function su(t,e,n,r={}){var s;const i=(t=Wt(t,ii))._getSettings();if(i.host!=="firestore.googleapis.com"&&i.host!==e&&rs("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let o,a;if(typeof r.mockUserToken=="string")o=r.mockUserToken,a=Z.MOCK_USER;else{o=Gu(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new S(g.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new Z(c)}t._authCredentials=new uf(new ic(o,a))}}class he{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new he(this.firestore,e,this._key)}}class oi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new oi(this.firestore,e,this._query)}}class Qt extends oi{constructor(e,n,r){super(e,n,Hs(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new he(this.firestore,null,new T(e))}withConverter(e){return new Qt(this.firestore,e,this._path)}}function go(t,e,...n){if(t=Nn(t),arguments.length===1&&(e=oc.R()),Vp("doc","path",e),t instanceof ii){const r=P.fromString(e,...n);return fo(r),new he(t,null,new T(r))}{if(!(t instanceof he||t instanceof Qt))throw new S(g.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(P.fromString(e,...n));return fo(r),new he(t.firestore,t instanceof Qt?t.converter:null,new T(r))}}class Up{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):Ce("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}class Bp{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Z.UNAUTHENTICATED,this.clientId=oc.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{b("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(b("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new S(g.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Me;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ti(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function jp(t,e){t.asyncQueue.verifyOperationInProgress(),b("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Bc(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function qp(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Hp(t);b("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>co(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>co(e.remoteStore,i)),t.onlineComponents=e}async function Hp(t){return t.offlineComponents||(b("FirestoreClient","Using default OfflineComponentProvider"),await jp(t,new Pp)),t.offlineComponents}async function iu(t){return t.onlineComponents||(b("FirestoreClient","Using default OnlineComponentProvider"),await qp(t,new Fp)),t.onlineComponents}function Kp(t){return iu(t).then(e=>e.syncEngine)}async function zp(t){const e=await iu(t),n=e.eventManager;return n.onListen=Sp.bind(null,e.syncEngine),n.onUnlisten=Cp.bind(null,e.syncEngine),n}function Gp(t,e,n={}){const r=new Me;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,c){const l=new Up({next:d=>{i.enqueueAndForget(()=>gp(s,u));const h=d.docs.has(o);!h&&d.fromCache?c.reject(new S(g.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&d.fromCache&&a&&a.source==="server"?c.reject(new S(g.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),u=new _p(Hs(o.path),l,{includeMetadataChanges:!0,Nu:!0});return mp(s,u)}(await zp(t),t.asyncQueue,e,n,r)),r.promise}class Wp{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new qc(this,"async_queue_retry"),this.Wc=()=>{const n=Mr();n&&b("AsyncQueue","Visibility state changed to "+n.visibilityState),this.xo.Po()};const e=Mr();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;const n=Mr();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.qc)return new Promise(()=>{});const n=new Me;return this.Hc(()=>this.qc&&this.Qc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}async Jc(){if(this.Lc.length!==0){try{await this.Lc[0](),this.Lc.shift(),this.xo.reset()}catch(e){if(!an(e))throw e;b("AsyncQueue","Operation failed with retryable error: "+e)}this.Lc.length>0&&this.xo.Ro(()=>this.Jc())}}Hc(e){const n=this.Bc.then(()=>(this.Gc=!0,e().catch(r=>{this.Kc=r,this.Gc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw Ce("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Gc=!1,r))));return this.Bc=n,n}enqueueAfterDelay(e,n,r){this.zc(),this.jc.indexOf(e)>-1&&(n=0);const s=ei.createAndSchedule(this,e,n,r,i=>this.Yc(i));return this.Uc.push(s),s}zc(){this.Kc&&C()}verifyOperationInProgress(){}async Xc(){let e;do e=this.Bc,await e;while(e!==this.Bc)}Zc(e){for(const n of this.Uc)if(n.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.Uc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Uc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const n=this.Uc.indexOf(e);this.Uc.splice(n,1)}}class ai extends ii{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Wp,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||au(this),this._firestoreClient.terminate()}}function Qp(t,e){const n=typeof t=="object"?t:Ql(),r=typeof t=="string"?t:e||"(default)",s=Kl(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Hu("firestore");i&&su(s,...i)}return s}function ou(t){return t._firestoreClient||au(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function au(t){var e;const n=t._freezeSettings(),r=function(s,i,o,a){return new bf(s,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Bp(t._authCredentials,t._appCheckCredentials,t._queue,r)}class mt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mt(se.fromBase64String(e))}catch(n){throw new S(g.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new mt(se.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ci{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new S(g.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new te(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class cu{constructor(e){this._methodName=e}}class ui{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new S(g.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new S(g.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return O(this._lat,e._lat)||O(this._long,e._long)}}const Xp=/^__.*__$/;class Yp{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ye(e,this.data,this.fieldMask,n,this.fieldTransforms):new cn(e,this.data,n,this.fieldTransforms)}}function uu(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw C()}}class li{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.yt=r,this.ignoreUndefinedProperties=s,i===void 0&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new li(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ia({path:r,oa:!1});return s.ua(e),s}ca(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ia({path:r,oa:!1});return s.na(),s}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return Gn(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(e.length===0)throw this.ha("Document fields must not be empty");if(uu(this.sa)&&Xp.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class Jp{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.yt=r||yr(e)}da(e,n,r,s=!1){return new li({sa:e,methodName:n,fa:r,path:te.emptyPath(),oa:!1,la:s},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function Zp(t){const e=t._freezeSettings(),n=yr(t._databaseId);return new Jp(t._databaseId,!!e.ignoreUndefinedProperties,n)}function em(t,e,n,r,s,i={}){const o=t.da(i.merge||i.mergeFields?2:0,e,n,s);du("Data must be an object, but it was:",o,r);const a=hu(r,o);let c,l;if(i.merge)c=new ge(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const d of i.mergeFields){const h=tm(e,d,n);if(!o.contains(h))throw new S(g.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);rm(u,h)||u.push(h)}c=new ge(u),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new Yp(new le(a),c,l)}function lu(t,e){if(fu(t=Nn(t)))return du("Unsupported field value:",e,t),hu(t,e);if(t instanceof cu)return function(n,r){if(!uu(r.sa))throw r.ha(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.oa&&e.sa!==4)throw e.ha("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let a=lu(o,r.aa(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=Nn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return qf(r.yt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=j.fromDate(n);return{timestampValue:Kn(r.yt,s)}}if(n instanceof j){const s=new j(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Kn(r.yt,s)}}if(n instanceof ui)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof mt)return{bytesValue:Mc(r.yt,n._byteString)};if(n instanceof he){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:zs(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.ha(`Unsupported field value: ${si(n)}`)}(t,e)}function hu(t,e){const n={};return ac(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wt(t,(r,s)=>{const i=lu(s,e.ra(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function fu(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof j||t instanceof ui||t instanceof mt||t instanceof he||t instanceof cu)}function du(t,e,n){if(!fu(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=si(n);throw r==="an object"?e.ha(t+" a custom object"):e.ha(t+" "+r)}}function tm(t,e,n){if((e=Nn(e))instanceof ci)return e._internalPath;if(typeof e=="string")return pu(t,e);throw Gn("Field path arguments must be of type string or ",t,!1,void 0,n)}const nm=new RegExp("[~\\*/\\[\\]]");function pu(t,e,n){if(e.search(nm)>=0)throw Gn(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ci(...e.split("."))._internalPath}catch{throw Gn(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Gn(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new S(g.INVALID_ARGUMENT,a+t+c)}function rm(t,e){return t.some(n=>n.isEqual(e))}class mu{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new he(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new sm(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(gu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class sm extends mu{data(){return super.data()}}function gu(t,e){return typeof e=="string"?pu(t,e):e instanceof ci?e._internalPath:e._delegate._internalPath}class im{convertValue(e,n="none"){switch(Qe(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(lt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw C()}}convertObject(e,n){const r={};return wt(e.fields,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new ui($(e.latitude),$(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=uc(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ht(e));default:return null}}convertTimestamp(e){const n=Fe(e);return new j(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=P.fromString(e);L(Uc(r));const s=new qt(r.get(1),r.get(3)),i=new T(r.popFirst(5));return s.isEqual(n)||Ce(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}function om(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class am{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yu extends mu{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new cm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(gu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class cm extends yu{data(e={}){return super.data(e)}}function um(t){t=Wt(t,he);const e=Wt(t.firestore,ai);return Gp(ou(e),t._key).then(n=>dm(e,t,n))}class lm extends im{constructor(e){super(),this.firestore=e}convertBytes(e){return new mt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new he(this.firestore,null,n)}}function hm(t,e,n){t=Wt(t,he);const r=Wt(t.firestore,ai),s=om(t.converter,e,n);return fm(r,[em(Zp(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Se.none())])}function fm(t,e){return function(n,r){const s=new Me;return n.asyncQueue.enqueueAndForget(async()=>Ap(await Kp(n),r,s)),s.promise}(ou(t),e)}function dm(t,e,n){const r=n.docs.get(e._key),s=new lm(t);return new yu(t,s,e._key,r,new am(n.hasPendingWrites,n.fromCache),e.converter)}(function(t,e=!0){(function(n){_t=n})(Wl),Rn(new Mt("firestore",(n,{instanceIdentifier:r,options:s})=>{const i=n.getProvider("app").getImmediate(),o=new ai(new lf(n.getProvider("auth-internal")),new pf(n.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new S(g.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qt(a.options.projectId,c)}(i,r),i);return s=Object.assign({useFetchStreams:e},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),it(Ui,"3.8.0",t),it(Ui,"3.8.0","esm2017")})();var wr,U,Pr,yo,Wn=0,vu=[],Tn=[],vo=y.__b,_o=y.__r,wo=y.diffed,Eo=y.__c,bo=y.unmount;function hi(t,e){y.__h&&y.__h(U,t,Wn||e),Wn=0;var n=U.__H||(U.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({__V:Tn}),n.__[t]}function st(t){return Wn=1,pm(wu,t)}function pm(t,e,n){var r=hi(wr++,2);if(r.t=t,!r.__c&&(r.__=[n?n(e):wu(void 0,e),function(i){var o=r.__N?r.__N[0]:r.__[0],a=r.t(o,i);o!==a&&(r.__N=[a,r.__[1]],r.__c.setState({}))}],r.__c=U,!U.u)){U.u=!0;var s=U.shouldComponentUpdate;U.shouldComponentUpdate=function(i,o,a){if(!r.__c.__H)return!0;var c=r.__c.__H.__.filter(function(u){return u.__c});if(c.every(function(u){return!u.__N}))return!s||s.call(this,i,o,a);var l=!1;return c.forEach(function(u){if(u.__N){var d=u.__[0];u.__=u.__N,u.__N=void 0,d!==u.__[0]&&(l=!0)}}),!(!l&&r.__c.props===i)&&(!s||s.call(this,i,o,a))}}return r.__N||r.__}function Fr(t,e){var n=hi(wr++,3);!y.__s&&_u(n.__H,e)&&(n.__=t,n.i=e,U.__H.__h.push(n))}function To(t){return Wn=5,mm(function(){return{current:t}},[])}function mm(t,e){var n=hi(wr++,7);return _u(n.__H,e)?(n.__V=t(),n.i=e,n.__h=t,n.__V):n.__}function gm(){for(var t;t=vu.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(Sn),t.__H.__h.forEach(ps),t.__H.__h=[]}catch(e){t.__H.__h=[],y.__e(e,t.__v)}}y.__b=function(t){U=null,vo&&vo(t)},y.__r=function(t){_o&&_o(t),wr=0;var e=(U=t.__c).__H;e&&(Pr===U?(e.__h=[],U.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=Tn,n.__N=n.i=void 0})):(e.__h.forEach(Sn),e.__h.forEach(ps),e.__h=[])),Pr=U},y.diffed=function(t){wo&&wo(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(vu.push(e)!==1&&yo===y.requestAnimationFrame||((yo=y.requestAnimationFrame)||ym)(gm)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==Tn&&(n.__=n.__V),n.i=void 0,n.__V=Tn})),Pr=U=null},y.__c=function(t,e){e.some(function(n){try{n.__h.forEach(Sn),n.__h=n.__h.filter(function(r){return!r.__||ps(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],y.__e(r,n.__v)}}),Eo&&Eo(t,e)},y.unmount=function(t){bo&&bo(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{Sn(r)}catch(s){e=s}}),n.__H=void 0,e&&y.__e(e,n.__v))};var So=typeof requestAnimationFrame=="function";function ym(t){var e,n=function(){clearTimeout(r),So&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,100);So&&(e=requestAnimationFrame(n))}function Sn(t){var e=U,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),U=e}function ps(t){var e=U;t.__c=t.__(),U=e}function _u(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function wu(t,e){return typeof e=="function"?e(t):e}var vm=0;function z(t,e,n,r,s){var i,o,a={};for(o in e)o=="ref"?i=e[o]:a[o]=e[o];var c={type:t,props:a,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--vm,__source:s,__self:r};if(typeof t=="function"&&(i=t.defaultProps))for(o in i)a[o]===void 0&&(a[o]=i[o]);return y.vnode&&y.vnode(c),c}var et="D:\\Documents\\web-write\\src\\components\\Authed\\index.tsx";const _m=({children:t,...e})=>{const[n,r]=Ne(st(!1),"authed"),[s,i]=Ne(st(""),"codeInput");return n?z(ve,{children:t},void 0,!1):z("div",{...e,style:{display:"flex",flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.2)"},children:z("div",{style:{display:"flex",borderRadius:15,background:"linear-gradient(0deg, var(--background), rgba(255, 255, 255, 0.1))",overflow:"hidden",flexDirection:"column"},children:[z("div",{style:{margin:"15px",display:"flex",flexDirection:"column"},children:[z("span",{style:{marginBottom:10,fontSize:"1.2em",textAlign:"center"},children:"Enter code:"},void 0,!1,{fileName:et,lineNumber:37,columnNumber:11},void 0),z("input",{value:s,onInput:o=>{i(o.currentTarget.value)},type:"password",style:{textAlign:"center"}},void 0,!1,{fileName:et,lineNumber:42,columnNumber:11},void 0)]},void 0,!0,{fileName:et,lineNumber:34,columnNumber:9},void 0),z("div",{className:"button",onClick:()=>{s==="1097"?r(!0):alert("Incorrect code")},children:"Submit"},void 0,!1,{fileName:et,lineNumber:51,columnNumber:9},void 0)]},void 0,!0,{fileName:et,lineNumber:24,columnNumber:7},void 0)},void 0,!1,{fileName:et,lineNumber:14,columnNumber:5})};function Eu(t,e){for(var n in e)t[n]=e[n];return t}function Io(t,e){for(var n in t)if(n!=="__source"&&!(n in e))return!0;for(var r in e)if(r!=="__source"&&t[r]!==e[r])return!0;return!1}function Co(t){this.props=t}(Co.prototype=new ce).isPureReactComponent=!0,Co.prototype.shouldComponentUpdate=function(t,e){return Io(this.props,t)||Io(this.state,e)};var Ao=y.__b;y.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),Ao&&Ao(t)};var wm=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Em(t){function e(n){var r=Eu({},n);return delete r.ref,t(r,n.ref||null)}return e.$$typeof=wm,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var bm=y.__e;y.__e=function(t,e,n,r){if(t.then){for(var s,i=e;i=i.__;)if((s=i.__c)&&s.__c)return e.__e==null&&(e.__e=n.__e,e.__k=n.__k),s.__c(t,e)}bm(t,e,n,r)};var Do=y.unmount;function bu(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),t.__c.__H=null),(t=Eu({},t)).__c!=null&&(t.__c.__P===n&&(t.__c.__P=e),t.__c=null),t.__k=t.__k&&t.__k.map(function(r){return bu(r,e,n)})),t}function Tu(t,e,n){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(r){return Tu(r,e,n)}),t.__c&&t.__c.__P===e&&(t.__e&&n.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=n)),t}function Vr(){this.__u=0,this.t=null,this.__b=null}function Su(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function vn(){this.u=null,this.o=null}y.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&t.__h===!0&&(t.type=null),Do&&Do(t)},(Vr.prototype=new ce).__c=function(t,e){var n=e.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var s=Su(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,s?s(a):a())};n.__R=o;var a=function(){if(!--r.__u){if(r.state.__a){var l=r.state.__a;r.__v.__k[0]=Tu(l,l.__c.__P,l.__c.__O)}var u;for(r.setState({__a:r.__b=null});u=r.t.pop();)u.forceUpdate()}},c=e.__h===!0;r.__u++||c||r.setState({__a:r.__b=r.__v.__k[0]}),t.then(o,o)},Vr.prototype.componentWillUnmount=function(){this.t=[]},Vr.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=bu(this.__b,n,r.__O=r.__P)}this.__b=null}var s=e.__a&&$r(ve,null,t.fallback);return s&&(s.__h=null),[$r(ve,null,e.__a?null:t.children),s]};var ko=function(t,e,n){if(++n[1]===n[0]&&t.o.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.o.size))for(n=t.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}};(vn.prototype=new ce).__a=function(t){var e=this,n=Su(e.__v),r=e.o.get(t);return r[0]++,function(s){var i=function(){e.props.revealOrder?(r.push(s),ko(e,t,r)):s()};n?n(i):i()}},vn.prototype.render=function(t){this.u=null,this.o=new Map;var e=An(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var n=e.length;n--;)this.o.set(e[n],this.u=[1,0,this.u]);return t.children},vn.prototype.componentDidUpdate=vn.prototype.componentDidMount=function(){var t=this;this.o.forEach(function(e,n){ko(t,n,e)})};var Tm=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Sm=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Im=typeof document<"u",Cm=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(t)};ce.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(ce.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var No=y.event;function Am(){}function Dm(){return this.cancelBubble}function km(){return this.defaultPrevented}y.event=function(t){return No&&(t=No(t)),t.persist=Am,t.isPropagationStopped=Dm,t.isDefaultPrevented=km,t.nativeEvent=t};var xo={configurable:!0,get:function(){return this.class}},Ro=y.vnode;y.vnode=function(t){var e=t.type,n=t.props,r=n;if(typeof e=="string"){var s=e.indexOf("-")===-1;for(var i in r={},n){var o=n[i];Im&&i==="children"&&e==="noscript"||i==="value"&&"defaultValue"in n&&o==null||(i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&o===!0?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+e)&&!Cm(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():s&&Sm.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():o===null&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}e=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=An(n.children).forEach(function(a){a.props.selected=r.value.indexOf(a.props.value)!=-1})),e=="select"&&r.defaultValue!=null&&(r.value=An(n.children).forEach(function(a){a.props.selected=r.multiple?r.defaultValue.indexOf(a.props.value)!=-1:r.defaultValue==a.props.value})),t.props=r,n.class!=n.className&&(xo.enumerable="className"in n,n.className!=null&&(r.class=n.className),Object.defineProperty(r,"className",xo))}t.$$typeof=Tm,Ro&&Ro(t)};var Oo=y.__r;y.__r=function(t){Oo&&Oo(t),t.__c};var Nm="D:\\Documents\\web-write\\src\\components\\LineNumber\\index.tsx";const Lo=Em(({number:t,...e},n)=>z("div",{ref:n,...e,style:{color:"var(--text-light)",display:"flex",lineHeight:"1.2em",fontSize:"1.2em",margin:"0 auto",padding:"0 0.2em",userSelect:"none"},children:t},void 0,!1,{fileName:Nm,lineNumber:11,columnNumber:7}));var xm="firebase",Rm="9.15.0";it(xm,Rm,"app");const Om={apiKey:"AIzaSyDfN6GfM5EEjjMdjrFnEF2VafU6HAf5ahU",authDomain:"web-write.firebaseapp.com",projectId:"web-write",storageBucket:"web-write.appspot.com",messagingSenderId:"813196725379",appId:"1:813196725379:web:c9baaa3ed1c8c147c7dfb6"},Lm=ea(Om),ms=Qp(Lm);(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&su(ms,"localhost",8080);var be="D:\\Documents\\web-write\\src\\app.tsx";function Mm(){const[t,e]=Ne(st(""),"value"),[n,r]=Ne(st(!0),"saved"),[s,i]=Ne(st(""),"debouncedValue"),o=Ne(To(!0),"isLoading"),a=Ne(To(null),"lineElem"),[c,l]=Ne(st(1),"textAreaLineCount");return Fr(()=>{const u=(t.match(/\n/g)||[]).length;if(l(u+1),t===s)return;r(!1);const d=setTimeout(()=>{i(t)},500);return()=>{clearTimeout(d)}},[t]),Fr(()=>{const u=async()=>{try{await hm(go(ms,"text","textDoc"),{value:s})}catch(d){console.error(d)}r(!0)};o.current||u()},[s]),Fr(()=>{(async()=>{var d;try{const h=await um(go(ms,"text","textDoc"));h.exists()&&e(((d=h.data())==null?void 0:d.value)??"")}catch(h){console.error(h)}o.current=!1})()},[]),z(_m,{children:z("div",{style:{display:"flex",flex:1,flexDirection:"column"},children:[z("div",{style:{backgroundColor:"var(--background-light)",position:"sticky",top:0,display:"flex",justifyContent:"center"},children:z("span",{style:{color:"var(--text-light)",fontSize:"0.8em",padding:"0.2em 0"},children:n?"Saved":"..."},void 0,!1,{fileName:be,lineNumber:88,columnNumber:11},this)},void 0,!1,{fileName:be,lineNumber:79,columnNumber:9},this),z("div",{style:{display:"flex",flexDirection:"row",flex:1},children:[z("div",{style:{display:"flex",width:"fit-content",flexDirection:"column",backgroundColor:"var(--background-light)",marginRight:"0.5em",paddingTop:"0.5rem",boxSizing:"border-box",alignSelf:"stretch",minWidth:"2.5em"},children:[z(Lo,{ref:a,number:1},void 0,!1,{fileName:be,lineNumber:112,columnNumber:13},this),Array.from({length:c-1},(u,d)=>d+2).map(u=>z(Lo,{number:u},u,!1,{fileName:be,lineNumber:115,columnNumber:17},this))]},void 0,!0,{fileName:be,lineNumber:99,columnNumber:11},this),z("textarea",{className:"textarea",value:t,onInput:u=>{e(u.currentTarget.value??"")},type:"text",style:{lineHeight:"1.2em",fontSize:"1.2em",paddingTop:"0.5rem",boxSizing:"border-box",backgroundColor:"var(--background)",display:"flex",flex:1,overflowY:"hidden",overflowX:"auto",resize:"none",color:"#fff",whiteSpace:"pre"}},void 0,!1,{fileName:be,lineNumber:119,columnNumber:11},this)]},void 0,!0,{fileName:be,lineNumber:98,columnNumber:9},this)]},void 0,!0,{fileName:be,lineNumber:72,columnNumber:7},this)},void 0,!1,{fileName:be,lineNumber:71,columnNumber:5})}var Pm="D:\\Documents\\web-write\\src\\main.tsx";Nu(z(Mm,{},void 0,!1,{fileName:Pm,lineNumber:5,columnNumber:8}),document.getElementById("app"));
